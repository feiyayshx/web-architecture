<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://feiyayshx.github.io/web-architecture</id>
    <title>å¢¨çœ‰</title>
    <updated>2021-03-24T01:26:10.645Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://feiyayshx.github.io/web-architecture"/>
    <link rel="self" href="https://feiyayshx.github.io/web-architecture/atom.xml"/>
    <subtitle>æ¸©æ•…è€ŒçŸ¥æ–°</subtitle>
    <logo>https://feiyayshx.github.io/web-architecture/images/avatar.png</logo>
    <icon>https://feiyayshx.github.io/web-architecture/favicon.ico</icon>
    <rights>All rights reserved 2021, å¢¨çœ‰</rights>
    <entry>
        <title type="html"><![CDATA[Vue æ ¸å¿ƒåŸç†åŠå¼€å‘æ€»ç»“]]></title>
        <id>https://feiyayshx.github.io/web-architecture/post/vue-he-xin-yuan-li-ji-kai-fa-zong-jie/</id>
        <link href="https://feiyayshx.github.io/web-architecture/post/vue-he-xin-yuan-li-ji-kai-fa-zong-jie/">
        </link>
        <updated>2021-02-11T06:15:14.000Z</updated>
        <content type="html"><![CDATA[<h3 id="babelrc-é…ç½®">.babelrc é…ç½®</h3>
<pre><code>{
   // é¢„è®¾ï¼Œæ’ä»¶çš„é›†åˆ
  &quot;presets&quot;: [
      // æŠŠes6è½¬åŒ–ä¸ºes5
    &quot;@babel/preset-env&quot;
  ]
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[H5å¼€å‘-å¸¸ç”¨åŠŸèƒ½å®ç°æ–¹æ¡ˆæ±‡æ€»]]></title>
        <id>https://feiyayshx.github.io/web-architecture/post/h5-kai-fa-chang-yong-gong-neng-shi-xian-fang-an-hui-zong/</id>
        <link href="https://feiyayshx.github.io/web-architecture/post/h5-kai-fa-chang-yong-gong-neng-shi-xian-fang-an-hui-zong/">
        </link>
        <updated>2021-02-02T06:12:36.000Z</updated>
        <content type="html"><![CDATA[<h3 id="h5å®ç°ä¸€é”®æ‹¨å·çš„ç”µè¯æ‹¨æ‰“åŠŸèƒ½">h5å®ç°ä¸€é”®æ‹¨å·çš„ç”µè¯æ‹¨æ‰“åŠŸèƒ½</h3>
<pre><code>&lt;a href=&quot;tel:13764567708&quot;&gt;ç§»åŠ¨WEBé¡µé¢ä¸€é”®æ‹¨æ‰“å·ç &lt;/a&gt;
// qq æµè§ˆå™¨å…¼å®¹æ€§ä¸å¥½
</code></pre>
<h3 id="h5å®ç°ä¸€é”®å‘é€çŸ­ä¿¡åŠŸèƒ½">h5å®ç°ä¸€é”®å‘é€çŸ­ä¿¡åŠŸèƒ½</h3>
<pre><code>&lt;a href=&quot;sms:13764567708&quot;&gt;ç§»åŠ¨WEBé¡µé¢ä¸€é”®å‘é€çŸ­ä¿¡&lt;/a&gt;
// qq æµè§ˆå™¨å…¼å®¹æ€§ä¸å¥½
</code></pre>
<h3 id="ç§»åŠ¨webé¡µé¢è‡ªåŠ¨æ¢æµ‹ç”µè¯å·ç ">ç§»åŠ¨webé¡µé¢è‡ªåŠ¨æ¢æµ‹ç”µè¯å·ç </h3>
<pre><code>&lt;meta name=&quot;format-detection&quot;  content=&quot;telephone=yes&quot;&gt;

&lt;meta  http-equiv=&quot;x-rim-auto-match&quot; content=&quot;none&quot;&gt;

</code></pre>
<h3 id="ä½¿ç”¨wtaiåè®®è¿›è¡Œæ‹¨æ‰“ç”µè¯">ä½¿ç”¨wtaiåè®®è¿›è¡Œæ‹¨æ‰“ç”µè¯</h3>
<pre><code>&lt;a href=&quot;wtai://wp//mc;13764567708&quot;&gt;æ‹¨æ‰“10086 &lt;/a&gt; 
&lt; a href=&quot;wtai://wp/ap;13764567708;&quot;&gt;å°†10086å­˜å‚¨è‡³ç”µè¯ç°¿ &lt;/a&gt;

</code></pre>
<h3 id="h5é¡µé¢è°ƒç”¨é«˜å¾·h5åœ°å›¾">h5é¡µé¢è°ƒç”¨é«˜å¾·h5åœ°å›¾</h3>
<pre><code>åœ¨è°ƒç”¨å¤„ï¼Œæ‰“å¼€è¯¥é“¾æ¥åœ°å€ï¼Œä¼ å…¥å‚å…¥
https://uri.amap.com/marker?position=116.473195,39.993253&amp;name=åœ°å€&amp;callnative=1
</code></pre>
<p><a href="https://developer.amap.com/api/uri-api/summary/">é«˜å¾·h5åœ°å›¾å¼€å‘æ–‡æ¡£</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ç§»åŠ¨ç«¯å¸ƒå±€ç›¸å…³æ¦‚å¿µåŠæœ¯è¯­]]></title>
        <id>https://feiyayshx.github.io/web-architecture/post/h5-word/</id>
        <link href="https://feiyayshx.github.io/web-architecture/post/h5-word/">
        </link>
        <updated>2020-10-26T02:27:01.000Z</updated>
        <summary type="html"><![CDATA[<p>âœŠä¸€å¤§å †æ¦‚å¿µæ¥äº†ï¼Œåˆ«å†å‚»å‚»åˆ†ä¸æ¸…ä»€ä¹ˆæ˜¯åƒç´ ã€åˆ†è¾¨ç‡ã€PPIã€DPIã€DPRã€è§†å£...  ä¸€æ–‡æ‰«ç›²,ä¸å†è¿·èŒ«ï¼</p>
]]></summary>
        <content type="html"><![CDATA[<p>âœŠä¸€å¤§å †æ¦‚å¿µæ¥äº†ï¼Œåˆ«å†å‚»å‚»åˆ†ä¸æ¸…ä»€ä¹ˆæ˜¯åƒç´ ã€åˆ†è¾¨ç‡ã€PPIã€DPIã€DPRã€è§†å£...  ä¸€æ–‡æ‰«ç›²,ä¸å†è¿·èŒ«ï¼</p>
<!-- more -->
<h2 id="1-åƒç´ ">1.  åƒç´ </h2>
<p><strong>åƒç´ </strong>ï¼šæ˜¯ç»„æˆå›¾åƒçš„æœ€å°å•ä½ï¼Œæ¯ä¸€ä¸ªåƒç´ éƒ½æœ‰ç‰¹å®šçš„ä½ç½®å’Œè‰²å½©å€¼ã€‚</p>
<p>å›¾ç‰‡ã€ç”µå­å±å¹•éƒ½æ˜¯ç”±ä¸€ä¸ªä¸ªåƒç´ ç»„æˆçš„ã€‚</p>
<h3 id="11-ç‰©ç†åƒç´ ">1.1 ç‰©ç†åƒç´ </h3>
<p><strong>ç‰©ç†åƒç´ </strong>ï¼šä¹Ÿå«<strong>è®¾å¤‡åƒç´ </strong>, æŒ‡è®¾å¤‡ä¸ŠçœŸå®çš„ç‰©ç†å•å…ƒã€‚</p>
<p>ä¾‹å¦‚ï¼šå±å¹•æ˜¾ç¤ºå™¨çš„åƒç´ ç‚¹ï¼Œæ‰“å°æœºçš„å¢¨ç‚¹ç­‰ã€‚</p>
<h3 id="12-é€»è¾‘åƒç´ ">1.2 é€»è¾‘åƒç´ </h3>
<p>é€»è¾‘åƒç´ ï¼šä¹Ÿå«è®¾å¤‡ç‹¬ç«‹åƒç´ ï¼ˆDevice Independent Pixels , ç®€å†™ï¼šDIPæˆ–DP )ã€‚ ååº”åœ¨css/jsç¨‹åºä¸­çš„åƒç´ ç‚¹ã€‚</p>
<p>æ‰€ä»¥ï¼Œ CSSåƒç´ æ˜¯é€»è¾‘åƒç´ çš„ä¸€ç§ã€‚<br>
å½“æè¿°ä¸€å¼ å›¾ç‰‡å®½é«˜æ—¶ï¼Œä¸€èˆ¬ç”¨ 200px * 100pxï¼Œè¿™é‡Œçš„pxä¹Ÿæ˜¯é€»è¾‘åƒç´ ã€‚</p>
<h2 id="2-è‹±å¯¸">2. è‹±å¯¸</h2>
<p>è‹±å¯¸ï¼šä¸€èˆ¬ç”¨æ¥æè¿°å±å¹•çš„ç‰©ç†å¤§å°ã€‚</p>
<p>ä¾‹å¦‚ï¼šç”µè„‘æ˜¾ç¤ºå™¨13è‹±å¯¸ï¼Œ15è‹±å¯¸ç­‰ï¼Œæ‰‹æœºæ˜¾ç¤ºå™¨5.7è‹±å¯¸ã€‚ è¿™é‡Œçš„è‹±å¯¸å¤§å°æŒ‡çš„æ˜¯å±å¹•çš„å¯¹è§’çº¿é•¿åº¦ã€‚</p>
<h2 id="3-åˆ†è¾¨ç‡">3. åˆ†è¾¨ç‡</h2>
<h3 id="31-å±å¹•åˆ†è¾¨ç‡">3.1 å±å¹•åˆ†è¾¨ç‡</h3>
<p>å±å¹•åˆ†è¾¨ç‡æŒ‡ä¸€ä¸ªå±å¹•æœ‰å¤šå°‘ä¸ªåƒç´ ç‚¹ç»„æˆã€‚</p>
<p>ä¾‹å¦‚ï¼šiPhone XS Max åˆ†è¾¨ç‡ä¸º2688 x 1242åƒç´ ï¼Œè¿™è¡¨ç¤ºæ‰‹æœºåˆ†åˆ«åœ¨å‚ç›´å’Œæ°´å¹³ä¸Šæ‰€å…·æœ‰çš„åƒç´ ç‚¹æ•°ã€‚</p>
<p><strong>å½“ç„¶åˆ†è¾¨ç‡é«˜ä¸ä»£è¡¨å±å¹•å°±æ¸…æ™°ï¼Œå±å¹•çš„æ¸…æ™°ç¨‹åº¦è¿˜ä¸å°ºå¯¸æœ‰å…³ã€‚</strong></p>
<h3 id="32-å›¾åƒåˆ†è¾¨ç‡">3.2 å›¾åƒåˆ†è¾¨ç‡</h3>
<p>å›¾ç‰‡åˆ†è¾¨ç‡å…¶å®æ˜¯æŒ‡å›¾ç‰‡å«æœ‰çš„åƒç´ æ•°ã€‚</p>
<p>ä¾‹å¦‚ï¼šä¸€å¼ å›¾ç‰‡çš„åˆ†è¾¨ç‡ä¸º800 x 400ï¼Œè¿™è¡¨ç¤ºå›¾ç‰‡åˆ†åˆ«åœ¨å‚ç›´å’Œæ°´å¹³ä¸Šæ‰€å…·æœ‰çš„åƒç´ ç‚¹æ•°ä¸º800å’Œ400ã€‚</p>
<p><strong>åŒä¸€å°ºå¯¸çš„å›¾ç‰‡ï¼Œåˆ†è¾¨ç‡è¶Šé«˜ï¼Œå›¾ç‰‡è¶Šæ¸…æ™°ã€‚</strong></p>
<h2 id="4-ppi-pixel-per-inch">4. PPI (pixel per Inch)</h2>
<p>PPI: æ¯è‹±å¯¸åŒ…å«çš„åƒç´ æ•°ã€‚</p>
<p>PPI å¯ä»¥ç”¨æ¥æè¿°å±å¹•çš„æ¸…æ™°åº¦æˆ–å›¾ç‰‡çš„è´¨é‡ã€‚<br>
å½“PPI æè¿°å±å¹•æ—¶ï¼ŒPPIè¶Šé«˜ï¼Œå±å¹•è¶Šæ¸…æ™°ï¼›å½“PPI æè¿°å›¾ç‰‡æ—¶ï¼ŒPPIè¶Šé«˜ï¼Œå›¾ç‰‡è´¨é‡è¶Šé«˜ã€‚</p>
<p>ä¾‹å¦‚ï¼šiPhone XS Max å’Œ iPhone SEçš„PPIåˆ†åˆ«ä¸º458å’Œ326ï¼Œè¯´æ˜iPhone XS Maxæ¯” iPhone SEçš„å±å¹•æ›´æ¸…æ™°ã€‚</p>
<h2 id="5-dpidot-per-inch">5. DPIï¼ˆDot per Inchï¼‰</h2>
<p>DPI: æ¯è‹±å¯¸åŒ…å«çš„ç‚¹æ•°ã€‚è¿™é‡Œçš„ç‚¹æ˜¯ä¸€ä¸ªæŠ½è±¡å•ä½ï¼Œå¯ä»¥æ˜¯å±å¹•çš„åƒç´ ç‚¹ï¼Œå›¾ç‰‡çš„åƒç´ ç‚¹ï¼Œæˆ–è€…æ‰“å°æœºçš„å¢¨ç‚¹ã€‚</p>
<p>å½“DPIæè¿°å±å¹•å’Œå›¾ç‰‡æ—¶ï¼Œåˆ™ç­‰ä»·äºPPIã€‚<br>
å½“DPIæè¿°æ‰“å°æœºæ—¶ï¼Œåˆ™è¡¨ç¤ºæ‰“å°æœºæ¯è‹±å¯¸å¯ä»¥æ‰“å°çš„ç‚¹æ•°ã€‚</p>
<p>æ‰“å°æœºçš„DPIè¶Šé«˜ï¼Œæ‰“å°å›¾åƒçš„ç²¾ç»†ç¨‹åº¦å°±è¶Šé«˜ï¼ŒåŒæ—¶è¿™ä¹Ÿä¼šæ¶ˆè€—æ›´å¤šçš„å¢¨ç‚¹å’Œæ—¶é—´ã€‚</p>
<h2 id="6-dpr-device-pixel-ratio">6. DPR (Device Pixel Ratio)</h2>
<p>è®¾å¤‡åƒç´ æ¯”ï¼šç‰©ç†åƒç´ /è®¾å¤‡ç‹¬ç«‹åƒç´ ã€‚</p>
<p>åœ¨webä¸­ï¼Œé€šè¿‡æµè§ˆå™¨æä¾›çš„window.devicePixelRatio è·å–dprï¼›</p>
<p>åœ¨cssä¸­ï¼Œé€šè¿‡åª’ä½“æŸ¥è¯¢min-device-pixel-ratioåŒºåˆ†dprï¼›</p>
<h2 id="7-ç§»åŠ¨ç«¯å¼€å‘">7. ç§»åŠ¨ç«¯å¼€å‘</h2>
<p>åœ¨iOSã€Androidå’ŒReact Nativeå¼€å‘ä¸­æ ·å¼å•ä½å…¶å®éƒ½ä½¿ç”¨çš„æ˜¯è®¾å¤‡ç‹¬ç«‹åƒç´ ã€‚</p>
<p>åœ¨ä½¿ç”¨RNå¼€å‘app, æˆ–è€…å¼€å‘h5æ—¶ï¼ŒUIè®¾è®¡ä¸€èˆ¬æ˜¯åŸºäºiphone6çš„åƒç´ è®¾è®¡çš„ã€‚iphone6çš„ç‰©ç†åƒç´ 750*1334ï¼Œè®¾å¤‡åƒç´ æ¯”æ˜¯2ã€‚ä¸ºäº†é€‚é…æ‰€æœ‰æœºå‹ï¼Œåœ¨å†™æ ·å¼æ—¶éœ€è¦æŠŠç‰©ç†åƒç´ è½¬ä¸ºè®¾å¤‡ç‹¬ç«‹åƒç´ ã€‚<br>
ä¾‹å¦‚ï¼šç»™å®šä¸€ä¸ªå…ƒç´ ï¼Œå®½åº¦300pxï¼Œæ ·å¼å¸ƒå±€æ—¶çš„å®½åº¦å°±æ˜¯150px = 300px/2;  æ‰€ä»¥ï¼Œä¸ºäº†å‡å°‘è®¡ç®—ï¼Œè®¾è®¡å›¾å¯ä»¥ç›´æ¥æŒ‰è®¾å¤‡ç‹¬ç«‹åƒç´ ç»™å‡ºã€‚</p>
<h2 id="8-webç«¯å¼€å‘">8. webç«¯å¼€å‘</h2>
<p>åœ¨PCç«¯å¼€å‘æ—¶ï¼Œå½“é¡µé¢æ­£å¸¸æƒ…å†µä¸‹ï¼Œå³ç¼©æ”¾æ¯”ä¾‹100%ï¼Œä¸€ä¸ªcssåƒç´ ç­‰äºä¸€ä¸ªè®¾å¤‡ç‹¬ç«‹åƒç´ ï¼›<br>
å½“ç”¨æˆ·å¯¹æµè§ˆå™¨è¿›è¡Œäº†æ”¾å¤§ï¼Œcssåƒç´ ä¹Ÿä¼šæ”¾å¤§ï¼Œä¸€ä¸ªcssåƒç´ ä¼šè·¨è¶Šæ›´å¤šçš„ç‰©ç†åƒç´ ï¼›<br>
<strong>é¡µé¢æ”¾å¤§æ¯”ä¾‹ = cssåƒç´ /è®¾å¤‡ç‹¬ç«‹åƒç´ </strong></p>
<h2 id="9-retina-å±å¹•">9. Retina å±å¹•</h2>
<p>Retina æ˜¯ä¸€ç§é«˜åˆ†è¾¨ç‡çš„æ˜¾ç¤ºæ ‡å‡†ï¼ŒæŠŠæ›´å¤šçš„åƒç´ ç‚¹å‹ç¼©è‡³ä¸€å—å±å¹•é‡Œï¼Œä»è€Œè¾¾åˆ°æ›´é«˜çš„åˆ†è¾¨ç‡ï¼Œå¹¶æé«˜å±å¹•æ˜¾ç¤ºçš„ç»†è…»ç¨‹åº¦ã€‚ä¹Ÿç§°ä¸ºè§†ç½‘è†œæ˜¾ç¤ºå±ã€‚åœ¨æ­£å¸¸è§‚çœ‹è·ç¦»ä¸‹è¶³ä»¥ä½¿äººè‚‰çœ¼æ— æ³•åˆ†è¾¨å…¶ä¸­çš„å•ç‹¬åƒç´ ã€‚</p>
<p>ç¬¬ä¸‰ä»£iPadå‘å¸ƒä¼šä¸Šï¼Œè‹¹æœç»™å‡ºäº†Retinaè®¾è®¡æ ‡å‡†çš„å…¬å¼ï¼š<br>
<img src="https://feiyayshx.github.io/web-architecture/post-images/1603701724180.png" alt="" loading="lazy"></p>
<p>å…¶ä¸­ aä»£è¡¨äººçœ¼è§†è§’ï¼Œh ä»£è¡¨åƒç´ é—´è·ï¼Œdä»£è¡¨è‚‰çœ¼ä¸å±å¹•çš„è·ç¦»ã€‚ç¬¦åˆä»¥ä¸Šæ¡ä»¶çš„å±å¹•å¯ä»¥ä½¿è‚‰çœ¼çœ‹ä¸è§å•ä¸ªç‰©ç†åƒç´ ç‚¹ã€‚è¿™æ ·çš„IPSå±å¹•å°±å¯è¢«è‹¹æœç§°ä½œâ€œRetinaæ˜¾ç¤ºå±â€ã€‚</p>
<p>å®ƒä¸èƒ½å•çº¯çš„è¡¨è¾¾åˆ†è¾¨ç‡å’ŒPPIï¼Œåªæ˜¯è¡¨è¾¾è§†è§‰æ•ˆæœã€‚</p>
<p>è®©å¤šä¸ªç‰©ç†åƒç´ æ¸²æŸ“ä¸€ä¸ªç‹¬ç«‹åƒç´ åªæ˜¯Retinaå±å¹•ä¸ºäº†è¾¾åˆ°æ•ˆæœè€Œä½¿ç”¨çš„ä¸€ç§æŠ€æœ¯ã€‚è€Œä¸æ˜¯æ‰€æœ‰dpr &gt; 1çš„å±å¹•å°±æ˜¯Retinaå±å¹•ã€‚</p>
<p>ä¾‹å¦‚ï¼šç»™ä½ ä¸€å—è¶…å¤§å°ºå¯¸çš„å±å¹•ï¼Œå³ä½¿å®ƒçš„PPIå¾ˆé«˜ï¼ŒDPRä¹Ÿå¾ˆé«˜ï¼Œåœ¨è¿‘è·ç¦»ä½ ä¹Ÿèƒ½çœ‹æ¸…å®ƒçš„åƒç´ ç‚¹ï¼Œè¿™å°±ä¸ç®—Retinaå±å¹•ã€‚</p>
<p>å¸¸è§åœ°æˆ‘ä»¬ä½¿ç”¨Kå’ŒPæ¥æè¿°å±å¹•çš„å¤§å°æˆ–æ¸…æ™°åº¦ï¼š</p>
<p>Kä»£è¡¨å±å¹•æ¨ªå‘æœ‰å‡ ä¸ª1024ä¸ªåƒç´ ï¼Œä¸€èˆ¬æ¥è®²æ¨ªå‘åƒç´ è¶…è¿‡2048å°±å±äº2Kå±ï¼Œæ¨ªå‘åƒç´ è¶…è¿‡4096å°±å±äº4Kå±ã€‚</p>
<p>Pä»£è¡¨çš„å°±æ˜¯å±å¹•çºµå‘çš„åƒç´ ä¸ªæ•°ï¼Œ1080På³çºµå‘æœ‰1080ä¸ªåƒç´ ï¼Œåˆ†è¾¨ç‡ä¸º1920X1080çš„å±å¹•å°±å±äº1080På±å¹•ã€‚</p>
<p>æ‰€è°“çš„é«˜æ¸…å±å…¶å®å°±æ˜¯å±å¹•çš„ç‰©ç†åˆ†è¾¨ç‡è¾¾åˆ°æˆ–è¶…è¿‡1920X1080çš„å±å¹•ã€‚</p>
<h2 id="10-viewport-è§†å£">10. viewport (è§†å£)</h2>
<p>è§†å£(viewport)ä»£è¡¨å½“å‰å¯è§çš„è®¡ç®—æœºå›¾å½¢åŒºåŸŸã€‚åœ¨ Web æµè§ˆå™¨æœ¯è¯­ä¸­ï¼Œé€šå¸¸ä¸æµè§ˆå™¨çª—å£ç›¸åŒï¼Œä½†ä¸åŒ…æ‹¬æµè§ˆå™¨çš„ UIï¼Œ èœå•æ ç­‰â€”â€”å³æŒ‡ä½ æ­£åœ¨æµè§ˆçš„æ–‡æ¡£çš„é‚£ä¸€éƒ¨åˆ†ã€‚</p>
<p>ä¸€èˆ¬è§†å£æœ‰ä¸‰ç§ï¼šå¸ƒå±€è§†å£ã€è§†è§‰è§†å£ã€ç†æƒ³è§†å£ã€‚</p>
<blockquote>
<p>viewport å¤§å°æ˜¯å¯å˜çš„ï¼Œå› ä¸ºviewport çš„å®½åº¦å¹¶ä¸æ€»æ˜¯çª—å£çš„å®½åº¦ã€‚</p>
</blockquote>
<h3 id="101-å¸ƒå±€è§†å£layout-viewport">10.1 å¸ƒå±€è§†å£ï¼ˆlayout viewportï¼‰</h3>
<p>å¸ƒå±€è§†å£æ˜¯ç½‘é¡µå¸ƒå±€çš„åŸºå‡†çª—å£ã€‚</p>
<p>åœ¨PCç«¯ï¼Œå¸ƒå±€è§†å£ç­‰äºæµè§ˆå™¨çª—å£(ä¸åŒ…æ‹¬borders,margins,æ»šåŠ¨æ¡ï¼Œæµè§ˆå™¨æ¡†æ¶)ï¼›</p>
<p>åœ¨ç§»åŠ¨ç«¯ï¼Œå¸ƒå±€è§†å£å¾€å¾€å¤§äºæµè§ˆå™¨çª—å£ï¼Œä¸€èˆ¬ç»™å®šä¸€ä¸ªé»˜è®¤å€¼<strong>980px</strong>, èƒ½å¤Ÿè®©PCçš„ç½‘é¡µå¯ä»¥åœ¨æ‰‹æœºæµè§ˆå™¨ä¸Šå‘ˆç°ï¼Œä½†æ˜¯éå¸¸å°ï¼Œç”¨æˆ·å¯ä»¥æ‰‹åŠ¨å¯¹ç½‘é¡µè¿›è¡Œæ”¾å¤§ã€‚</p>
<p>æˆ‘ä»¬é€šè¿‡<code>document.documentElement.clientWidth/clientHeight</code> è·å–å¸ƒå±€è§†å£çš„å¤§å°ã€‚</p>
<h3 id="102-è§†è§‰è§†å£visual-viewport">10.2 è§†è§‰è§†å£ï¼ˆvisual viewportï¼‰</h3>
<p>è§†è§‰è§†å£æ˜¯ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­çœ‹åˆ°çš„ç½‘é¡µåŒºåŸŸï¼Œå®ƒæ˜¯å¯å˜åŒ–çš„ã€‚</p>
<p>ç”¨æˆ·å¯ä»¥é€šè¿‡ç¼©æ”¾æ¥æŸ¥çœ‹ç½‘é¡µå†…å®¹ï¼Œå½“ç”¨æˆ·æ”¾å¤§ç½‘é¡µæ—¶ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°çš„ç½‘é¡µåŒºåŸŸç¼©å°ï¼Œæ­¤æ—¶è§†è§‰è§†å£å˜å°ï¼›åŒæ ·ï¼Œå½“ç”¨æˆ·ç¼©å°ç½‘é¡µæ—¶ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°çš„ç½‘é¡µåŒºåŸŸå˜å¤§ï¼Œæ­¤æ—¶è§†è§‰è§†å£ä¹Ÿå˜å¤§ï¼›ä¸ç®¡æ”¾å¤§è¿˜æ˜¯ç¼©å°ç½‘é¡µï¼Œå¸ƒå±€è§†å£å§‹ç»ˆä¸å˜ã€‚</p>
<p>é€šè¿‡è°ƒç”¨<code>window.innerWidth / innerHeight</code> æ¥è·å–è§†è§‰è§†å£å¤§å°ã€‚</p>
<h3 id="103-ç†æƒ³è§†å£-ideal-viewport">10.3 ç†æƒ³è§†å£ ï¼ˆideal viewportï¼‰</h3>
<p>ç†æƒ³è§†å£æ˜¯å¸ƒå±€è§†å£çš„ä¸€ä¸ªç†æƒ³å°ºå¯¸ã€‚</p>
<p>åªæœ‰å½“å¸ƒå±€è§†å£çš„å°ºå¯¸ç­‰äºè®¾å¤‡å±å¹•çš„å°ºå¯¸æ—¶ï¼Œæ‰æ˜¯ç†æƒ³è§†å£ã€‚</p>
<p>å½“é¡µé¢ç¼©æ”¾æ¯”ä¾‹ä¸º100%æ—¶ï¼ŒCSSåƒç´  = è®¾å¤‡ç‹¬ç«‹åƒç´ ï¼Œç†æƒ³è§†å£ = è§†è§‰è§†å£</p>
<p>é€šè¿‡ <code>window.screen.width/height</code> è·å–ç†æƒ³è§†å£å¤§å°ã€‚</p>
<blockquote>
<p>å¸ƒå±€è§†å£é™åˆ¶css å¸ƒå±€ï¼Œè§†è§‰è§†å£æ§åˆ¶ç”¨æˆ·çœ‹åˆ°çš„ç½‘é¡µå†…å®¹ï¼›<br>
åœ¨webæµè§ˆå™¨ä¸­æœ‰ä¸¤ä¸ªè§†å£ï¼šå¸ƒå±€è§†å£ï¼Œè§†è§‰è§†å£ï¼›<br>
åœ¨ç§»åŠ¨ç«¯ï¼Œé™¤äº†å¸ƒå±€è§†å£ï¼Œè§†è§‰è§†å£ï¼Œè¿˜æœ‰ä¸€ä¸ªç†æƒ³è§†å£ã€‚å®ƒæ˜¯å¯¹ç‰¹å®šæµè§ˆå™¨çš„å¸ƒå±€è§†å£çš„ä¸€ä¸ªç†æƒ³å°ºå¯¸ã€‚</p>
</blockquote>
<h2 id="11-ç§»åŠ¨ç«¯é€‚é…">11. ç§»åŠ¨ç«¯é€‚é…</h2>
<p>ç§»åŠ¨è®¾å¤‡é»˜è®¤çš„viewport æ˜¯å¸ƒå±€è§†å£(layout viewport), å¸ƒå±€è§†å£ä¸€èˆ¬æ¯”å±å¹•å¤§çš„å¤šï¼Œåœ¨ç§»åŠ¨ç«¯å¸ƒå±€å¼€å‘æ—¶ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ç†æƒ³è§†å£ï¼ˆideal viewportï¼‰ï¼›æ­¤æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥meta æ ‡ç­¾è®¾ç½®viewportã€‚</p>
<p>meta viewport æ ‡ç­¾é¦–å…ˆæ˜¯ç”±è‹¹æœå…¬å¸åœ¨å…¶safariæµè§ˆå™¨ä¸­å¼•å…¥çš„ï¼Œç›®çš„å°±æ˜¯è§£å†³ç§»åŠ¨è®¾å¤‡çš„viewporté—®é¢˜ã€‚åæ¥å„å¤§æµè§ˆå™¨å‚å•†ä¹Ÿéƒ½æ”¯æŒäº†å®ƒã€‚</p>
<p><code>&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width; initial-scale=1; maximum-scale=1; minimum-scale=1; user-scalable=no;&quot;&gt;</code></p>
<p>viewportçš„é…ç½®å±æ€§å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th style="text-align:center">Value</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>width</td>
<td style="text-align:center">æ­£æ•´æ•°æˆ–è€…device-width</td>
<td>ä»¥pxä¸ºå•ä½ï¼Œå®šä¹‰layout viewportçš„å®½åº¦</td>
</tr>
<tr>
<td>height</td>
<td style="text-align:center">æ­£æ•´æ•°æˆ–è€…device-height</td>
<td>ä»¥pxä¸ºå•ä½ï¼Œå®šä¹‰layout viewportçš„é«˜åº¦</td>
</tr>
<tr>
<td>initial-scale</td>
<td style="text-align:center">0.0-10.0</td>
<td>å®šä¹‰é¡µé¢åˆå§‹ç¼©æ”¾æ¯”ç‡</td>
</tr>
<tr>
<td>minimum-scale</td>
<td style="text-align:center">0.0-10.0</td>
<td>å®šä¹‰ç¼©æ”¾çš„æœ€å°å€¼ï¼›å¿…é¡»å°äºæˆ–ç­‰äºmaximum-scaleçš„å€¼</td>
</tr>
<tr>
<td>maximum-scale</td>
<td style="text-align:center">0.0-10.0</td>
<td>å®šä¹‰ç¼©æ”¾çš„æœ€å¤§å€¼ï¼›å¿…é¡»å¤§äºæˆ–ç­‰äºminimum-scaleçš„å€¼</td>
</tr>
<tr>
<td>user-scalable</td>
<td style="text-align:center">yesæˆ–è€…no</td>
<td>å¦‚æœè®¾ç½®ä¸º noï¼Œç”¨æˆ·å°†ä¸èƒ½æ”¾å¤§æˆ–ç¼©å°ç½‘é¡µã€‚é»˜è®¤å€¼ä¸º yes</td>
</tr>
</tbody>
</table>
<p><strong>ç§»åŠ¨ç«¯å¸ƒå±€</strong></p>
<p>åœ¨ç§»åŠ¨ç«¯ï¼Œä¸ºäº†è®©é¡µé¢å¸ƒå±€è¾¾åˆ°ç†æƒ³æ•ˆæœï¼Œéœ€è¦è®©å¸ƒå±€è§†å£ï¼Œè§†è§‰è§†å£å°½å¯èƒ½ç­‰äºç†æƒ³è§†å£ï¼›</p>
<p>device-widthç­‰äºç†æƒ³è§†å£çš„å®½åº¦ï¼Œæ‰€ä»¥è®¾ç½®width=device-widthå°±ç›¸å½“äºè®©<strong>å¸ƒå±€è§†å£</strong>ç­‰äºç†æƒ³è§†å£ã€‚</p>
<p>ç”±äºinitial-scale = ç†æƒ³è§†å£å®½åº¦ / è§†è§‰è§†å£å®½åº¦ï¼Œæ‰€ä»¥æˆ‘ä»¬è®¾ç½®initial-scale=1;å°±ç›¸å½“äºè®©<strong>è§†è§‰è§†å£</strong>ç­‰äºç†æƒ³è§†å£ã€‚</p>
<p><strong>é¡µé¢ç¼©æ”¾</strong></p>
<p>å½“æˆ‘ä»¬è®¾ç½®widthæ—¶ï¼Œå¯ä»¥å†³å®šå¸ƒå±€è§†å£çš„å®½åº¦ï¼Œä½†æ˜¯è®¾ç½®initial-scaleä¹Ÿä¼šå½±å“åˆ°å¸ƒå±€è§†å£å®½åº¦ï¼Œå› ä¸ºå¸ƒå±€è§†å£å®½åº¦å–çš„æ˜¯widthå’Œè§†è§‰è§†å£å®½åº¦çš„æœ€å¤§å€¼ï¼Œå³ï¼š<code>å¸ƒå±€è§†å£å®½åº¦ = Math.max(width, è§†è§‰è§†å£å®½åº¦ï¼‰</code></p>
<p>ä¾‹å¦‚ï¼šåœ¨iphoneä¸­ï¼Œå¦‚æœç†æƒ³è§†å£çš„å®½åº¦æ˜¯320pxï¼Œè®¾ç½®width=device-width; initial-scale=2; åˆ™:   <code>è§†è§‰è§†å£å®½åº¦ = 320px/2 = 160px</code>, å¸ƒå±€è§†å£çš„å®½åº¦å–widthå’Œè§†è§‰è§†å£å®½åº¦çš„æœ€å¤§å€¼ï¼Œæ•…å¸ƒå±€è§†å£å®½åº¦æ˜¯400pxï¼›å¦‚æœè®¾ç½®initial-scale=0.5ï¼Œ<code>è§†è§‰è§†å£å®½åº¦ = 320px * 2 = 640px</code>, æ­¤æ—¶å¸ƒå±€è§†å£å®½åº¦å–æœ€å¤§å€¼640pxã€‚</p>
<p><em>å‚è€ƒæ–‡ç« </em>ï¼š</p>
<p><a href="http://www.conardli.top/blog/article/%E5%A4%9A%E7%AB%AF%E5%BC%80%E5%8F%91/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%80%82%E9%85%8D%E6%80%BB%E7%BB%93%EF%BC%88%E4%BA%8C%EF%BC%89%E5%BA%94%E7%94%A8%E7%AF%87.html#%E5%AF%BC%E8%AF%BB">ç§»åŠ¨ç«¯é€‚é…æ€»ç»“</a><br>
<a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/Viewport_concepts">è§†å£æ¦‚å¿µ</a><br>
<a href="https://www.jianshu.com/p/7c5fdf90c0ef">viewportã€å¸ƒå±€è§†å£ã€è§†è§‰è§†å£ã€ç†æƒ³è§†å£ æ·±å…¥ç†è§£</a></p>
<p><em>ç›¸å…³èµ„æ–™</em>ï¼š</p>
<p><a href="https://viewportsizes.com/?filter=">æ‰‹æœºè®¾å¤‡å°ºå¯¸ä¸€è§ˆè¡¨</a><br>
<a href="https://www.quirksmode.org/mobile/viewports.html">Peter-Paul Koch åšå®¢</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[SVNå‘½ä»¤]]></title>
        <id>https://feiyayshx.github.io/web-architecture/post/svn-command/</id>
        <link href="https://feiyayshx.github.io/web-architecture/post/svn-command/">
        </link>
        <updated>2020-10-09T05:56:42.000Z</updated>
        <summary type="html"><![CDATA[<p>ğŸ‘‰svn æ—¥å¸¸å‘½ä»¤ï¼Œ mac ç³»ç»Ÿä¸­æ“ä½œsvnå‘½ä»¤è¡Œã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p>ğŸ‘‰svn æ—¥å¸¸å‘½ä»¤ï¼Œ mac ç³»ç»Ÿä¸­æ“ä½œsvnå‘½ä»¤è¡Œã€‚</p>
<!-- more -->
<h3 id="ä»æœ¬åœ°å¯¼å…¥ä»£ç åˆ°æœåŠ¡å™¨">ä»æœ¬åœ°å¯¼å…¥ä»£ç åˆ°æœåŠ¡å™¨</h3>
<pre><code>svn import [æœ¬åœ°ä»“åº“åœ°å€]  [æœåŠ¡å™¨åœ°å€] --username=[ç”¨æˆ·å] --password=[å¯†ç ] -m 'æ³¨é‡Š'
// ä¾‹å¦‚ï¼š
svn import /Users/apple/Documents/eclipse_workspace/weibo svn://localhost/mycode/weibo --username=mj --password=123 -m &quot;åˆå§‹åŒ–å¯¼å…¥&quot;

</code></pre>
<h3 id="ä»æœåŠ¡å™¨æ£€å‡ºä»£ç åˆ°å½“å‰ç›®å½•">ä»æœåŠ¡å™¨æ£€å‡ºä»£ç åˆ°å½“å‰ç›®å½•</h3>
<p><code>svn checkout [svnåœ°å€]</code></p>
<p>ç®€å†™<br>
<code>svn co [svn é¡¹ç›®åœ°å€]</code></p>
<h3 id="æ·»åŠ æ–‡ä»¶åˆ°ç‰ˆæœ¬åº“">æ·»åŠ æ–‡ä»¶åˆ°ç‰ˆæœ¬åº“</h3>
<pre><code class="language-javascript">
// å°†æŸä¸ªæ–‡ä»¶æ·»åŠ åˆ°ç‰ˆæœ¬åº“
svn add [filePath]
// ä¾‹å¦‚, srcä¸‹é¢çš„index.js æ·»åŠ åˆ°ç‰ˆæœ¬åº“
svn add src/compiler/index.js

// æ·»åŠ æŸä¸ªç›®å½•ä¸‹é¢çš„æ‰€æœ‰æ–‡ä»¶
svn add src
</code></pre>
<h3 id="æ›´æ–°ä»£ç åˆ°æœ¬åœ°">æ›´æ–°ä»£ç åˆ°æœ¬åœ°</h3>
<p>æ›´æ–°åˆ°æŸä¸ªç‰ˆæœ¬<br>
<code>svn update -r m [path]</code><br>
ç®€å†™<br>
<code>svn up</code></p>
<h3 id="æäº¤ä»£ç åˆ°è¿œç¨‹">æäº¤ä»£ç åˆ°è¿œç¨‹</h3>
<p><code>svn commit -m 'æäº¤æ³¨é‡Š'</code></p>
<p>ç®€å†™<br>
<code>svn ci -m 'æäº¤æ³¨é‡Š'</code></p>
<h3 id="æ’¤é”€å·¥ä½œåŒºä¿®æ”¹çš„ä»£ç ">æ’¤é”€å·¥ä½œåŒºä¿®æ”¹çš„ä»£ç </h3>
<p><code>svn revert -R trunk</code></p>
<h3 id="æŸ¥çœ‹æ–‡ä»¶æˆ–ç›®å½•çŠ¶æ€">æŸ¥çœ‹æ–‡ä»¶æˆ–ç›®å½•çŠ¶æ€</h3>
<ul>
<li>
<p>æŸ¥çœ‹ç›®å½•ä¸‹çš„æ–‡ä»¶åŠå­—ç›®å½•çŠ¶æ€ï¼Œæ­£å¸¸çŠ¶æ€ä¸æ˜¾ç¤º<br>
<code>svn status [path]</code><br>
ã€?ï¼šä¸åœ¨svnçš„æ§åˆ¶ä¸­ï¼›Mï¼šå†…å®¹è¢«ä¿®æ”¹ï¼›Cï¼šå‘ç”Ÿå†²çªï¼›Aï¼šé¢„å®šåŠ å…¥åˆ°ç‰ˆæœ¬åº“ï¼›Kï¼šè¢«é”å®šï¼›!å·²ç»åˆ é™¤çš„æ–‡ä»¶ï¼Œä½†è¿˜æœªæ ‡è®°ä¸ºä»svnç‰ˆæœ¬åº“ä¸­åˆ é™¤ã€‘</p>
</li>
<li>
<p>svn status -v path(æ˜¾ç¤ºæ–‡ä»¶å’Œå­ç›®å½•çŠ¶æ€)</p>
</li>
</ul>
<h3 id="æŸ¥çœ‹æäº¤æ—¥å¿—">æŸ¥çœ‹æäº¤æ—¥å¿—</h3>
<p><code>svn log [path]</code></p>
<h3 id="æŸ¥çœ‹æ–‡ä»¶è¯¦ç»†ä¿¡æ¯">æŸ¥çœ‹æ–‡ä»¶è¯¦ç»†ä¿¡æ¯</h3>
<p><code>svn info [path]</code></p>
<h3 id="æ¯”è¾ƒå·®å¼‚">æ¯”è¾ƒå·®å¼‚</h3>
<p><code>svn diff path(å°†ä¿®æ”¹çš„æ–‡ä»¶ä¸åŸºç¡€ç‰ˆæœ¬æ¯”è¾ƒ)</code><br>
ä¾‹å¦‚ï¼š<code>svn diff test.php</code></p>
<p><code>svn diff -r m:n path(å¯¹ç‰ˆæœ¬må’Œç‰ˆæœ¬næ¯”è¾ƒå·®å¼‚)</code><br>
ä¾‹å¦‚ï¼š<code>svn diff -r 200:201 test.php</code></p>
<p>ç®€å†™ï¼š<code>svn di</code></p>
<h3 id="åŠ é”è§£é”">åŠ é”/è§£é”</h3>
<p><code>svn lock -m 'æ³¨é‡Š' path</code><br>
ä¾‹å¦‚ï¼šsvn lock -m â€œlock test fileâ€œ test.php<br>
è§£é”ï¼šsvn unlock PATH</p>
<h3 id="åˆ é™¤æ–‡ä»¶">åˆ é™¤æ–‡ä»¶</h3>
<p><code>svn delete path -m 'æ³¨é‡Š'</code><br>
ä¾‹å¦‚ï¼š<code>svn delete svn://192.168.1.1/pro/domain/test.php -m 'åˆ é™¤è¯´æ˜'</code><br>
æˆ–è€…ç›´æ¥<code>svn delete test.js</code>ç„¶åå†<code>svn ci -m 'åˆ é™¤è¯´æ˜'</code>ï¼Œæ¨èä½¿ç”¨è¿™ç§<br>
ç®€å†™ï¼šsvn (del, remove, rm)</p>
<h3 id="æ‰¹é‡åˆ é™¤æ·»åŠ ">æ‰¹é‡åˆ é™¤/æ·»åŠ </h3>
<p><code>svn status|grep ! |awk '{print $2}'|xargs svn del</code></p>
<p>å‘½ä»¤è§£é‡Šï¼š</p>
<ul>
<li>é¦–å…ˆæ‰§è¡Œsvn statusï¼ŒæŸ¥çœ‹svnçŠ¶æ€ï¼Œåˆ—å‡ºæ–‡ä»¶çš„æ‰€æœ‰æ”¹åŠ¨ï¼›</li>
<li>ï¼æ ‡è®°çš„æ–‡ä»¶æ˜¯å·²ç»åˆ é™¤çš„æ–‡ä»¶è¿˜æœªè¢«svnç‰ˆæœ¬åº“æ ‡è®°ï¼›grep ï¼æ˜¯å°†ï¼æ ‡è®°çš„æ–‡ä»¶å•ç‹¬æŠ½ç¦»å‡ºæ¥;</li>
<li>å†ç”¨awk '{print $2}'å°†æŠ½ç¦»å‡ºæ¥çš„æ–‡æœ¬ç»“æœå¤„ç†ï¼Œç•™ä¸‹æ¯ä¸€è¡Œçš„ç¬¬äºŒæ®µæ–‡å­—ï¼Œå³åé¢çš„æ–‡ä»¶åï¼›<br>
æ­¤å¤„å¿…é¡»æ³¨æ„ï¼Œsvn status|grep !å’Œåé¢çš„è¯­å¥|awk '{print $2}'|xargs svn delä¹‹é—´ï¼Œå¿…é¡»æœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œå¦åˆ™ç»ˆç«¯è¿˜æ˜¯ä¼šè®¤ä¸ºè¿™ä¸ª!å·æ˜¯ç‰¹æ®Šç¬¦å·ã€‚</li>
<li>æœ€åé€’äº¤ç»™svn delå‘½ä»¤ï¼Œä½¿ç”¨xargsè¿™ä¸ªå‚æ•°æ„é€ å‘½ä»¤ï¼Œå°†æ¯ä¸€è¡Œçš„æ–‡æœ¬ä½œä¸ºå‚æ•°æä¾›ç»™svn delï¼Œç»“æœå°±æ˜¯æ‰€æœ‰åˆ—å‡ºçš„æ–‡ä»¶éƒ½æ‰§è¡Œäº†ä¸€édeläº†ã€‚</li>
</ul>
<blockquote>
<p>æ‰¹é‡æ·»åŠ æ–‡ä»¶åŒç†ï¼Œåªæ˜¯æ ‡è®°ç¬¦å·æ˜¯ï¼Ÿ<code>svn status|grep ? |awk '{print $2}'|xargs svn add</code></p>
</blockquote>
<h3 id="è§£å†³å†²çª">è§£å†³å†²çª</h3>
<p><code>svn resolved [path]</code><br>
æ³¨æ„: æœ¬å­å‘½ä»¤ä¸ä¼šä¾è¯­æ³•æ¥è§£å†³å†²çªæˆ–æ˜¯ç§»é™¤å†²çªæ ‡è®°ï¼›å®ƒåªæ˜¯ç§»é™¤å†²çªçš„<br>
ç›¸å…³æ–‡ä»¶ï¼Œç„¶åè®© PATH å¯ä»¥å†æ¬¡æäº¤ã€‚</p>
<h3 id="å¿½ç•¥">å¿½ç•¥</h3>
<p>https://blog.csdn.net/qq_24909089/article/details/85334570</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Nodeç³»åˆ—ä¹‹streamæ¨¡å—]]></title>
        <id>https://feiyayshx.github.io/web-architecture/post/node-stream/</id>
        <link href="https://feiyayshx.github.io/web-architecture/post/node-stream/">
        </link>
        <updated>2020-09-28T08:04:25.000Z</updated>
        <summary type="html"><![CDATA[<p>ğŸ‘ å‰è¨€ï¼š æœ¬æ–‡æ˜¯å­¦ä¹ Nodeæ—¶ï¼Œå¯¹å…¶ä¸­streamæ¨¡å—å­¦ä¹ çš„ä¸€ä¸ªç¬”è®°æ€»ç»“ï¼Œä¸»è¦æ˜¯åŠ å¼ºç†è§£ï¼</p>
]]></summary>
        <content type="html"><![CDATA[<p>ğŸ‘ å‰è¨€ï¼š æœ¬æ–‡æ˜¯å­¦ä¹ Nodeæ—¶ï¼Œå¯¹å…¶ä¸­streamæ¨¡å—å­¦ä¹ çš„ä¸€ä¸ªç¬”è®°æ€»ç»“ï¼Œä¸»è¦æ˜¯åŠ å¼ºç†è§£ï¼</p>
<!-- more -->
<h2 id="1-æµçš„æ¦‚å¿µ">1. æµçš„æ¦‚å¿µ</h2>
<p>æµ(stream)æ˜¯node.jsä¸­å¤„ç†æµå¼æ•°æ®çš„æŠ½è±¡æ¥å£ã€‚</p>
<p>streamæ¨¡å—ç”¨äºæ„å»ºå®ç°äº†æµæ¥å£çš„å¯¹è±¡ã€‚</p>
<p>Node.js æä¾›äº†å¤šç§æµå¯¹è±¡ï¼Œä¾‹å¦‚ï¼ŒHTTP æœåŠ¡å™¨çš„è¯·æ±‚å’Œ process.stdout éƒ½æ˜¯æµçš„å®ä¾‹ã€‚</p>
<p>æµå¯ä»¥æ˜¯å¯è¯»çš„ã€å¯å†™çš„ã€æˆ–è€…å¯è¯»å¯å†™çš„ã€‚ æ‰€æœ‰çš„æµéƒ½æ˜¯ EventEmitter çš„å®ä¾‹ã€‚</p>
<h2 id="2-nodeä¸­å››ç§åŸºæœ¬çš„æµç±»å‹">2. Nodeä¸­å››ç§åŸºæœ¬çš„æµç±»å‹</h2>
<ul>
<li>
<p>Writable - å¯å†™å…¥æ•°æ®çš„æµï¼ˆä¾‹å¦‚ fs.createWriteStream()ï¼‰;</p>
</li>
<li>
<p>Readable - å¯è¯»å–æ•°æ®çš„æµï¼ˆä¾‹å¦‚ fs.createReadStream()ï¼‰;</p>
</li>
<li>
<p>Duplex - å¯è¯»åˆå¯å†™çš„æµï¼ˆä¾‹å¦‚ net.Socketï¼‰;</p>
</li>
<li>
<p>Transform - åœ¨è¯»å†™è¿‡ç¨‹ä¸­å¯ä»¥ä¿®æ”¹æˆ–è½¬æ¢æ•°æ®çš„ Duplex æµï¼ˆä¾‹å¦‚ zlib.createDeflate()ï¼‰ã€‚</p>
</li>
</ul>
<h2 id="3-æµçš„æ•°æ®æ¨¡å¼">3. æµçš„æ•°æ®æ¨¡å¼</h2>
<ul>
<li>
<p>äºŒè¿›åˆ¶æ¨¡å¼ï¼šNode.js åˆ›å»ºçš„æµéƒ½æ˜¯è¿ä½œåœ¨å­—ç¬¦ä¸²å’Œ Bufferï¼ˆæˆ– Uint8Arrayï¼‰ä¸Š;</p>
</li>
<li>
<p>å¯¹è±¡æ¨¡å¼(object mode)ï¼šå½“åˆ›å»ºæµæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ objectMode é€‰é¡¹æŠŠæµå®ä¾‹åˆ‡æ¢åˆ°å¯¹è±¡æ¨¡å¼ã€‚ å°†å·²å­˜åœ¨çš„æµåˆ‡æ¢åˆ°å¯¹è±¡æ¨¡å¼æ˜¯ä¸å®‰å…¨çš„</p>
</li>
</ul>
<h2 id="4-å¯è¯»æµçš„è¯»å–æ¨¡å¼">4. å¯è¯»æµçš„è¯»å–æ¨¡å¼</h2>
<p><strong>flowingæ¨¡å¼(æµåŠ¨æ¨¡å¼)</strong>ï¼šå¯è¯»æµè‡ªåŠ¨ä»ç³»ç»Ÿåº•å±‚è¯»å–æ•°æ®ï¼Œå¹¶é€šè¿‡EventEmitteræ¥å£çš„äº‹ä»¶å°†æ•°æ®æä¾›ç»™åº”ç”¨ï¼›</p>
<p><strong>pausedæ¨¡å¼(æš‚åœæ¨¡å¼)</strong>ï¼šå¿…é¡»æ˜¾å¼è°ƒç”¨stream.read()æ–¹æ³•ä»æµä¸­è¯»å–æ•°æ®ç‰‡æ®µï¼›</p>
<p>æ‰€æœ‰åˆå§‹å·¥ä½œæ¨¡å¼ä¸ºpausedçš„Readableæµï¼Œå¯ä»¥é€šè¿‡ä¸‰ç§æ–¹å¼åˆ‡æ¢åˆ°flowingæ¨¡å¼ï¼š</p>
<ul>
<li>ç›‘å¬dataäº‹ä»¶</li>
<li>è°ƒç”¨stream.resume()</li>
<li>è°ƒç”¨stream.pipe()æ–¹æ³•å°†æ•°æ®å‘é€åˆ°Writeable</li>
</ul>
<p>å¯è¯»æµReadableå¯é€šè¿‡ä¸‹åˆ—æ–¹å¼åˆ‡æ¢åˆ°pausedæ¨¡å¼ï¼š</p>
<ul>
<li>å¦‚æœä¸å­˜åœ¨ç®¡é“ç›®æ ‡ï¼ˆpipe destinationï¼‰ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨ stream.pause() æ–¹æ³•å®ç°ã€‚</li>
<li>å¦‚æœå­˜åœ¨ç®¡é“ç›®æ ‡ï¼Œå¯ä»¥é€šè¿‡å–æ¶ˆ 'data' äº‹ä»¶ç›‘å¬ï¼Œå¹¶è°ƒç”¨ stream.unpipe() æ–¹æ³•ç§»é™¤æ‰€æœ‰ç®¡é“ç›®æ ‡æ¥å®ç°ã€‚</li>
</ul>
<h2 id="5-å¯è¯»æµçš„ä¸‰ç§çŠ¶æ€">5. å¯è¯»æµçš„ä¸‰ç§çŠ¶æ€</h2>
<p>åœ¨ä»»æ„æ—¶åˆ»ï¼Œå¯è¯»æµåº”ç¡®åˆ‡å¤„äºä¸‹é¢ä¸‰ç§çŠ¶æ€ä¹‹ä¸€ï¼š</p>
<p><code>readable._readableState.flowing = null</code></p>
<p><code>readable._readableState.flowing = false</code></p>
<p><code>readable._readableState.flowing = true</code></p>
<ul>
<li>
<p>è‹¥<code>readable._readableState.flowing = null</code>ï¼Œç”±äºä¸å­˜åœ¨æ•°æ®æ¶ˆè´¹è€…ï¼Œå¯è¯»æµä¸ä¼šäº§ç”Ÿæ•°æ®ã€‚åœ¨æ­¤çŠ¶æ€ä¸‹ï¼Œç›‘å¬dataäº‹ä»¶ï¼Œè°ƒç”¨readable.pipe()æ–¹æ³•ï¼Œæˆ–è€…è°ƒç”¨readable.resume(),<code>readable._readableState.flowing</code>çš„å€¼å°†ä¼šå˜ä¸ºtrue, éšç€æ•°æ®ç”Ÿæˆï¼Œå¯è¯»æµå¼€å§‹é¢‘ç¹è§¦å‘äº‹ä»¶ã€‚</p>
</li>
<li>
<p>è°ƒç”¨<code>readable.pause()</code>,æˆ–è€…<code>readable.unpipe()</code>,æˆ–è€…æ¥æ”¶ â€œèƒŒå‹â€ï¼ˆback pressureï¼‰ï¼Œå°†å¯¼è‡´ readable._readableState.flowing å€¼å˜ä¸º falseã€‚è¿™å°†æš‚åœäº‹ä»¶æµï¼Œä½†ä¸ä¼šæš‚åœæ•°æ®ç”Ÿæˆï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸º 'data' äº‹ä»¶è®¾ç½®ç›‘å¬å‡½æ•°ä¸ä¼šå¯¼è‡´ <code>readable._readableState.flowing</code> å˜ä¸º trueã€‚</p>
</li>
<li>
<p>å½“ <code>readable._readableState.flowing</code> å€¼ä¸º false æ—¶ï¼Œ æ•°æ®å¯èƒ½å †ç§¯åˆ°æµçš„å†…éƒ¨ç¼“å­˜ä¸­ã€‚</p>
</li>
</ul>
<h2 id="6-ç¼“å†²">6. ç¼“å†²</h2>
<ul>
<li>
<p>å¯å†™æµå’Œå¯è¯»æµéƒ½ä¼šåœ¨å†…éƒ¨çš„ç¼“å†²å™¨ä¸­å­˜å‚¨æ•°æ®ï¼Œå¯ä»¥åˆ†åˆ«ä½¿ç”¨çš„ writable.writableBuffer æˆ– readable.readableBuffer æ¥è·å–ã€‚</p>
</li>
<li>
<p>å¯ç¼“å†²çš„æ•°æ®å¤§å°å–å†³äºä¼ å…¥æµæ„é€ å‡½æ•°çš„ highWaterMark é€‰é¡¹ã€‚ å¯¹äºæ™®é€šçš„æµï¼Œ highWaterMark æŒ‡å®šäº†å­—èŠ‚çš„æ€»æ•°ã€‚ å¯¹äºå¯¹è±¡æ¨¡å¼çš„æµï¼Œ highWaterMark æŒ‡å®šäº†å¯¹è±¡çš„æ€»æ•°ã€‚</p>
</li>
<li>
<p>å½“è°ƒç”¨ stream.push(chunk) æ—¶ï¼Œæ•°æ®ä¼šè¢«ç¼“å†²åœ¨å¯è¯»æµä¸­ã€‚ å¦‚æœæµçš„æ¶ˆè´¹è€…æ²¡æœ‰è°ƒç”¨ stream.read()ï¼Œåˆ™æ•°æ®ä¼šä¿ç•™åœ¨å†…éƒ¨é˜Ÿåˆ—ä¸­ç›´åˆ°è¢«æ¶ˆè´¹ã€‚</p>
</li>
<li>
<p>ä¸€æ—¦å†…éƒ¨çš„å¯è¯»ç¼“å†²çš„æ€»å¤§å°è¾¾åˆ° highWaterMark æŒ‡å®šçš„é˜ˆå€¼æ—¶ï¼Œæµä¼šæš‚æ—¶åœæ­¢ä»åº•å±‚èµ„æºè¯»å–æ•°æ®ï¼Œç›´åˆ°å½“å‰ç¼“å†²çš„æ•°æ®è¢«æ¶ˆè´¹ã€‚</p>
</li>
<li>
<p>å½“è°ƒç”¨ writable.write(chunk) æ—¶ï¼Œæ•°æ®ä¼šè¢«ç¼“å†²åœ¨å¯å†™æµä¸­ã€‚ å½“å†…éƒ¨çš„å¯å†™ç¼“å†²çš„æ€»å¤§å°å°äº highWaterMark è®¾ç½®çš„é˜ˆå€¼æ—¶ï¼Œè°ƒç”¨ writable.write() ä¼šè¿”å› trueã€‚ ä¸€æ—¦å†…éƒ¨ç¼“å†²çš„å¤§å°è¾¾åˆ°æˆ–è¶…è¿‡ highWaterMark æ—¶ï¼Œåˆ™ä¼šè¿”å› falseã€‚</p>
</li>
<li>
<p>Duplex å’Œ Transform éƒ½æ˜¯å¯è¯»å†™çš„ã€‚ åœ¨å†…éƒ¨ï¼Œå®ƒä»¬éƒ½ç»´æŠ¤äº† ä¸¤ä¸ª ç›¸äº’ç‹¬ç«‹çš„ç¼“å†²å™¨ç”¨äºè¯»å’Œå†™ã€‚ åœ¨ç»´æŒäº†åˆç†é«˜æ•ˆçš„æ•°æ®æµçš„åŒæ—¶ï¼Œä¹Ÿä½¿å¾—å¯¹äºè¯»å’Œå†™å¯ä»¥ç‹¬ç«‹è¿›è¡Œè€Œäº’ä¸å½±å“ã€‚</p>
</li>
<li>
<p>stream API çš„å…³é”®ç›®æ ‡ï¼Œ å°¤å…¶å¯¹äº stream.pipe() æ–¹æ³•ï¼Œ å°±æ˜¯é™åˆ¶ç¼“å†²å™¨æ•°æ®å¤§å°ï¼Œä»¥è¾¾åˆ°å¯æ¥å—çš„ç¨‹åº¦ã€‚è¿™æ ·ï¼Œå¯¹äºè¯»å†™é€Ÿåº¦ä¸åŒ¹é…çš„æºå¤´å’Œç›®æ ‡ï¼Œå°±ä¸ä¼šè¶…å‡ºå¯ç”¨çš„å†…å­˜å¤§å°ã€‚</p>
</li>
</ul>
<h2 id="7-è‡ªå®šä¹‰å¯è¯»æµ">7.  è‡ªå®šä¹‰å¯è¯»æµ</h2>
<p>ä¸ºäº†å®ç°å¯è¯»æµï¼Œç»§æ‰¿Readableæ¥å£å¹¶ç”¨å®ƒæ„é€ æ–°å¯¹è±¡</p>
<pre><code class="language-javascript">
const { Readable } = require('stream');

class MyRead extends Readable{ // é»˜è®¤ä¼šè°ƒç”¨Readableä¸­çš„readæ–¹æ³•
    _read(){
        // pushæ–¹æ³•æ˜¯Readableä¸­æä¾›çš„, è°ƒç”¨pushå°†ç»“æœæ”¾å…¥,å°±å¯ä»¥è§¦å‘ on('dataäº‹ä»¶')
        this.push('ok'); 
        // æ”¾å…¥nullè¡¨ç¤ºè¿™ä¸ªæµæ²¡æœ‰æ›´å¤šæ•°æ®äº†
        this.push(null); 
    }
}

let mr = new MyRead;
mr.on('data',function (data) {
    console.log(data);
})
mr.on('end',function () {
    console.log('end')
})
mr.on('open',function () {
    console.log('open')
})

</code></pre>
<h2 id="8-è‡ªå®šä¹‰å¯å†™æµ">8. è‡ªå®šä¹‰å¯å†™æµ</h2>
<p>è‡ªå®šä¹‰å¯å†™æµï¼Œç»§æ‰¿Writableæ¥å£æ¥æ„é€ æ–°å¯¹è±¡<br>
_write(chunk,encoding,callback)å‡½æ•°ï¼š</p>
<ul>
<li>chunké€šå¸¸æ˜¯ä¸€ä¸ªbufferï¼Œé™¤éæˆ‘ä»¬é…ç½®ä¸åŒçš„æµã€‚</li>
<li>encodingæ˜¯åœ¨ç‰¹å®šæƒ…å†µä¸‹éœ€è¦çš„å‚æ•°ï¼Œé€šå¸¸æˆ‘ä»¬å¯ä»¥å¿½ç•¥å®ƒã€‚</li>
<li>callbackæ˜¯åœ¨å®Œæˆå¤„ç†æ•°æ®å—åéœ€è¦è°ƒç”¨çš„å‡½æ•°ã€‚è¿™æ˜¯å†™æ•°æ®æˆåŠŸä¸å¦çš„æ ‡å¿—ã€‚è‹¥è¦å‘å‡ºæ•…éšœä¿¡å·ï¼Œè¯·ç”¨é”™è¯¯å¯¹è±¡è°ƒç”¨å›è°ƒå‡½æ•°</li>
</ul>
<pre><code class="language-javascript">
const { Writable } = require('stream')

class MyWrite extends Writable {
  _write(chunk, encoding, cb) {
    cb();
  }
}

let mw = new MyWrite();
mw.write('ok', function () {
  console.log('ok')
})
mw.write('ab')

</code></pre>
<h2 id="9-è‡ªå®šä¹‰åŒå·¥æµ">9. è‡ªå®šä¹‰åŒå·¥æµ</h2>
<p>åŒå·¥æµèƒ½è¯»åˆèƒ½å†™ï¼ŒåŒå·¥æµçš„å¯è¯»æ€§å’Œå¯å†™æ€§æ“ä½œå®Œå…¨ç‹¬ç«‹äºå½¼æ­¤ã€‚è¿™ä»…ä»…æ˜¯å°†ä¸¤ä¸ªç‰¹æ€§ç»„åˆæˆä¸€ä¸ªå¯¹è±¡ã€‚</p>
<pre><code class="language-javascript">
const { Duplex } = require('stream');
class MyDuplex extends Duplex{
    _read(){
        this.push('xxx');
        this.push(null)
    }
    _write(chunk,encoding,cb){
        console.log(chunk);
        cb() // clearBuffer
    }
}
let md = new MyDuplex();
md.on('data',function (chunk) {
    console.log(chunk)
})
md.write('ok');

</code></pre>
<h2 id="10-è‡ªå®šä¹‰è½¬æ¢æµ">10. è‡ªå®šä¹‰è½¬æ¢æµ</h2>
<ul>
<li>
<p>è½¬æ¢æµçš„è¾“å‡ºæ˜¯ä»è¾“å…¥ä¸­è®¡ç®—å‡ºæ¥çš„ã€‚</p>
</li>
<li>
<p>å¯¹äºè½¬æ¢æµï¼Œæˆ‘ä»¬ä¸å¿…å®ç°readæˆ–writeçš„æ–¹æ³•ï¼Œæˆ‘ä»¬åªéœ€è¦å®ç°ä¸€ä¸ªtransformæ–¹æ³•ï¼Œå°†ä¸¤è€…ç»“åˆèµ·æ¥ã€‚å®ƒæœ‰writeåŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥ç”¨å®ƒæ¥pushæ•°æ®ã€‚</p>
</li>
<li>
<p>å¯ä»¥ç”¨äºåŠ å¯†ã€å‹ç¼© ï¼Œå¯ä»¥æŠŠå¯å†™æµè½¬æ¢æˆå¯è¯»æµã€‚</p>
</li>
</ul>
<pre><code class="language-javascript">const { Transform } = require('stream');
class MyTransfrom extends Transform {
    _transform(chunk, encoding, cb) {
        // è¿™é‡Œå¯ä»¥è°ƒç”¨pushæ–¹æ³•
        this.push(chunk.toString().toUpperCase()); // this.emit()
        cb();
    }
}
let my = new MyTransfrom();
process.stdin.on('data',function (chunk) { // ç›‘æ§ç”¨æˆ·è¾“å…¥å†…å®¹
    process.stdout.write(chunk); 
})
process.stdin.pipe(my).pipe(process.stdout)
// process.std.write('ok'); // console.log() å¯å†™æµ

</code></pre>
<h2 id="11-ç®¡é“æµ">11. ç®¡é“æµ</h2>
<pre><code class="language-javascript">
const stream = require('stream')

var index = 0;
const readable = stream.Readable({
    highWaterMark: 2,
    read: function () {
        process.nextTick(() =&gt; {
            console.log('push', ++index)
            this.push(index+'');
        })
    }
})

const writable = stream.Writable({
    highWaterMark: 2,
    write: function (chunk, encoding, next) {
        console.log('å†™å…¥:', chunk.toString())
    }
})

readable.pipe(writable);

</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Nodeç³»åˆ—ä¹‹fsæ¨¡å—]]></title>
        <id>https://feiyayshx.github.io/web-architecture/post/node-fs/</id>
        <link href="https://feiyayshx.github.io/web-architecture/post/node-fs/">
        </link>
        <updated>2020-09-28T01:47:56.000Z</updated>
        <summary type="html"><![CDATA[<p>ğŸ‘ fsæ¨¡å—ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’ï¼Œæ‰€æœ‰çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œéƒ½å…·æœ‰åŒæ­¥çš„ã€å›è°ƒçš„ã€ä»¥åŠåŸºäº promise çš„å½¢å¼ã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p>ğŸ‘ fsæ¨¡å—ç”¨äºä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’ï¼Œæ‰€æœ‰çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œéƒ½å…·æœ‰åŒæ­¥çš„ã€å›è°ƒçš„ã€ä»¥åŠåŸºäº promise çš„å½¢å¼ã€‚</p>
<!-- more -->
<h2 id="ç›¸å…³åè¯">ç›¸å…³åè¯</h2>
<ul>
<li>æ–‡ä»¶æè¿°ç¬¦</li>
</ul>
<h2 id="fsæ–¹æ³•">fsæ–¹æ³•</h2>
<ul>
<li>fs.copyFile()</li>
<li>fs.access()</li>
</ul>
<h2 id="æ–‡ä»¶æ‹·è´ç®€å•ç‰ˆ">æ–‡ä»¶æ‹·è´(ç®€å•ç‰ˆ)</h2>
<ul>
<li>fs æ“ä½œæ¥å—çš„æ–‡ä»¶è·¯å¾„å¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€Buffer,æˆ–URLå¯¹è±¡;</li>
<li>å¦‚æœè¯»å–æ–‡ä»¶ï¼Œè¯»åˆ°çš„ç»“æœé»˜è®¤æ˜¯bufferç±»å‹;</li>
<li>å†™å…¥çš„æ—¶å€™ ä¼šæ¸…ç©ºæ–‡ä»¶å†…å®¹ï¼Œå¹¶ä¸”ä»¥utf8æ ¼å¼ç±»å‹å†™å…¥;</li>
</ul>
<pre><code class="language-javascript">
// å°†æ–‡ä»¶homework.jsä¸­çš„å†…å®¹æ‹·è´åˆ°demo.jsä¸­
const fs = require('fs')
const path = require('path')
fs.readFile(path.resolve(__dirname,'homework.js'),function(err,data) {
  fs.appendFile(path.resolve(__dirname,'demo.js'),data,function(err){
    console.log('copy finished')
  })
})

</code></pre>
<blockquote>
<p>æ³¨æ„ï¼šè¿è¡Œæ—¶å¦‚æœç”¨ç›¸å¯¹è·¯å¾„ï¼Œä¼šä»¥process.cwd() æ¥åˆ‡æ¢è·¯å¾„ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸åŒè·¯å¾„ä¸‹è¿è¡Œç»“æœä¸åŒã€‚æ•…ä½¿ç”¨ç»å¯¹è·¯å¾„ã€‚</p>
</blockquote>
<p><strong>ç¼ºç‚¹:</strong></p>
<ul>
<li>è¯»å–æ–‡ä»¶æ—¶ï¼Œè¯»å–çš„å†…å®¹æ”¾åœ¨å†…å­˜ä¸­ï¼Œå¦‚æœæ–‡ä»¶è¿‡å¤§ä¼šæµªè´¹å†…å­˜ï¼Œæ·¹æ²¡å¯ç”¨å†…å­˜ï¼Œå¤§å‹æ–‡ä»¶ä¸èƒ½é‡‡ç”¨æ­¤æ–¹å¼æ“ä½œï¼›ä¸€èˆ¬64kb ä»¥ä¸Šçš„æ–‡ä»¶å®ç°æ‹·è´å°½é‡ä¸è¦ä½¿ç”¨readFileæ–¹æ³•ã€‚</li>
</ul>
<h2 id="æ–‡ä»¶æ‹·è´æ”¹è¿›ç‰ˆ">æ–‡ä»¶æ‹·è´(æ”¹è¿›ç‰ˆ)</h2>
<p>ç®€å•ç‰ˆçš„æ–‡ä»¶æ‹·è´ä¸é€‚åˆè¯»å–å¤§æ–‡ä»¶ï¼Œå®¹æ˜“é€ æˆå†…å­˜æµªè´¹; å¯¹äºè¯»å–å¤§å‹æ–‡ä»¶çš„åœºæ™¯ï¼Œéœ€è¦åˆ†æ®µè¯»å–æ–‡ä»¶ï¼Œå®ç°è¯»å–ä¸€ç‚¹å†™å…¥ä¸€ç‚¹ï¼›æ ¸å¿ƒæ–¹æ³•æœ‰ï¼šfs.open()ã€fs.read()ã€fs.write()ã€fs.close()ã€‚</p>
<pre><code class="language-javascript">
const fs = require('fs')
function copyFile(source, target, callback) {
  const BUFFER_LENGTH = 6
  let readPosition = 0
  let writePosition = 0
  const buffer = Buffer.alloc(BUFFER_LENGTH)
  // æ‰“å¼€æ–‡ä»¶ï¼Œè¯»å–å†…å®¹
  fs.open(source, 'r', function (err, rfd) {
    // æ‰“å¼€æ–‡ä»¶ï¼Œå†™å…¥å†…å®¹
    fs.open(target, 'w', function (err, wfd) {
      function copy() {
        fs.read(rfd, buffer, 0, BUFFER_LENGTH, readPosition, function (err, bytesRead) {
          // è¯»å–åˆ°çš„å®é™…å­—èŠ‚æ•°
          if (err) return callback(err)
          if (bytesRead) {
            // å°†è¯»å–çš„æ•°æ®å†™å…¥æ–‡ä»¶
            fs.write(wfd, buffer, 0, bytesRead, writePosition, function (err, written) {
              readPosition += bytesRead
              writePosition += bytesRead
              copy();
            })
          } else {
            fs.close(rfd, () =&gt; { })
            fs.close(wfd, () =&gt; { })
            callback()
          }
        })
      }
      copy()
    })
  })
}

/*---------åŠŸèƒ½æµ‹è¯•----------*/
copyFile('./3.fs.js', './demo.js', function () {
  console.log('copy finished')
})

</code></pre>
<h2 id="æ–‡ä»¶æ‹·è´ç»ˆæç‰ˆ">æ–‡ä»¶æ‹·è´(ç»ˆæç‰ˆ)</h2>
<p>æ–‡ä»¶æ‹·è´çš„ç»ˆæç‰ˆæ˜¯å¯¹æ”¹è¿›ç‰ˆçš„ä¸€ç§ä¼˜åŒ–ï¼›fs åŸºäºæµå°è£…äº†æ–‡ä»¶çš„å¯è¯»æµæ–¹æ³•fs.createReadStreamå’Œå¯å†™æµæ–¹æ³•fs.createWriteStreamã€‚</p>
<h3 id="fscreatereadstream-å¯è¯»æµå†…éƒ¨å®ç°è¿‡ç¨‹åŠç”¨æ³•">fs.createReadStream å¯è¯»æµå†…éƒ¨å®ç°è¿‡ç¨‹åŠç”¨æ³•</h3>
<p>å®ç°äº†stream.Readableæ¥å£çš„å¯¹è±¡ï¼Œå°†å¯¹è±¡æ•°æ®è¯»å–ä¸ºæµæ•°æ®ï¼›</p>
<ul>
<li>
<ol>
<li>å†…éƒ¨è°ƒç”¨ new ReadStream, ç»§æ‰¿äºReadableæ¥å£ï¼›</li>
</ol>
</li>
<li>
<ol start="2">
<li>å…ˆè¿›è¡Œæ•°æ®æ ¼å¼åŒ–ï¼›</li>
</ol>
</li>
<li>
<ol start="3">
<li>é»˜è®¤æ‰“å¼€æ–‡ä»¶ï¼ŒReadStream.prototype.read</li>
</ol>
</li>
<li>
<ol start="4">
<li>Readable.prototype.read -&gt;  ReadStream.prototype._read</li>
</ol>
</li>
</ul>
<blockquote>
<p>æƒ³åŸºäºReadableæ¥å£å®ç°è‡ªå·±çš„å¯è¯»æµ ä½ éœ€è¦è‡ªå·±å»å®ç°ä¸€ä¸ª_readæ–¹æ³•ï¼Œé»˜è®¤å¼€å§‹è¯»å–æ—¶ä¼šå»è°ƒç”¨æ­¤æ–¹æ³•.<br>
å¯è¯»æµå¯¹è±¡ å¿…é¡»æœ‰on('data') on('end')  , æ–‡ä»¶æµä¼šæä¾›ä¸¤ä¸ªæ–¹æ³• open/close<br>
æ§åˆ¶è¯»å–é€Ÿç‡ rs.pause rs.resume</p>
</blockquote>
<h4 id="åˆ›å»ºå¯è¯»æµ">åˆ›å»ºå¯è¯»æµ</h4>
<pre><code class="language-javascript">
const fs = require('fs')
const path = require('path')

let readStream = fs.createReadStream(path.resolve(__dirname, 'demo.md'), {
  flags: 'r', // å¯è¯»æ€§æ ‡è¯†ï¼Œé»˜è®¤å€¼'r',è¯»å–æ–‡ä»¶
  encoding: null, // ç¼–ç ï¼Œé»˜è®¤null
  autoClose: false, // è¯»å–å®Œæ¯•åè‡ªåŠ¨å…³é—­ï¼Œé»˜è®¤true
  start: 0, // ä»æ–‡ä»¶ä¸­æŒ‡å®šå¼€å§‹ä½ç½®è¯»å–ï¼ŒåŒ…æ‹¬è¯¥ä½ç½®
  end: 4,   // æŒ‡å®šè¯»å–æ–‡ä»¶çš„ç»“æŸä½ç½®ï¼ŒåŒ…æ‹¬è¯¥ä½ç½®
  highWaterMark: 2 // æ¯æ¬¡è¯»å–çš„å­—èŠ‚æ•°ï¼Œé»˜è®¤64 * 1024 ä¸ªå­—èŠ‚

})

</code></pre>
<h4 id="ç›‘å¬dataäº‹ä»¶">ç›‘å¬dataäº‹ä»¶</h4>
<p>æµåˆ‡æ¢åˆ°æµåŠ¨æ¨¡å¼,æ•°æ®ä¼šè¢«å°½å¯èƒ½å¿«çš„è¯»å‡º</p>
<pre><code class="language-javascript">
let arr = []
// é»˜è®¤ä¸€æ—¦ç›‘å¬dataäº‹ä»¶ï¼Œä¼šä¸åœè§¦å‘dataæ–¹æ³•
readStream.on('data', function (chunk) {
  arr.push(chunk)
})
</code></pre>
<h4 id="ç›‘å¬endäº‹ä»¶">ç›‘å¬endäº‹ä»¶</h4>
<p>æ•°æ®è¯»å–å®Œæ¯•ï¼Œè§¦å‘endäº‹ä»¶</p>
<pre><code class="language-javascript">
readStream.on('end', function () {
  console.log(Buffer.concat(arr), 'æ–‡ä»¶è¯»å–å®Œæ¯•ï¼')
})
</code></pre>
<h4 id="ç›‘å¬erroräº‹ä»¶">ç›‘å¬erroräº‹ä»¶</h4>
<pre><code class="language-javascript">
readStream.on('error', function (err) {
  console.log(err)
})
</code></pre>
<h4 id="ç›‘å¬openäº‹ä»¶">ç›‘å¬openäº‹ä»¶</h4>
<pre><code class="language-javascript">
readStream.on('open', function (fd) {
  console.log(fd, 'open æ‰“å¼€æ–‡ä»¶')
})
</code></pre>
<h4 id="ç›‘å¬colseäº‹ä»¶">ç›‘å¬colseäº‹ä»¶</h4>
<pre><code class="language-javascript">
readStream.on('close',function(){
  console.log('close å…³é—­æ–‡ä»¶')
})
</code></pre>
<h4 id="è®¾ç½®ç¼–ç ">è®¾ç½®ç¼–ç </h4>
<p><code>readStream.setEncoding('utf8')</code></p>
<h4 id="æš‚åœå’Œæ¢å¤è§¦å‘data">æš‚åœå’Œæ¢å¤è§¦å‘data</h4>
<pre><code class="language-javascript">
readStream.on('data', function (data) {
    readStream.pause();  // æš‚åœè¯»å–
    console.log(data);
});
setTimeout(function () {
    readStream.resume(); // è¯»å–
},2000);
</code></pre>
<h3 id="fscreatewritestream-å¯å†™æµç”¨æ³•">fs.createWriteStream å¯å†™æµç”¨æ³•</h3>
<p>å®ç°äº†stream.Writeable æ¥å£å¯¹è±¡ï¼Œå°†æµæ•°æ®å†™å…¥åˆ°å¯¹è±¡ä¸­</p>
<h4 id="åˆ›å»ºå¯å†™æµ">åˆ›å»ºå¯å†™æµ</h4>
<pre><code class="language-javascript">
const fs = require('fs');
const path = require('path');

const ws = fs.createWriteStream(path.resolve(__dirname, 'test.txt'),{
    flags:'w',
    encoding:'utf8',
    autoClose:true,
    highWaterMark: 2// é»˜è®¤å†™çš„æ°´ä½çº¿æ˜¯16k
});

</code></pre>
<h4 id="write-æ–¹æ³•">write() æ–¹æ³•</h4>
<p><code>ws.write(chunk,[encoding],[callback])</code></p>
<ul>
<li>chunk: string/buffer</li>
<li>encoding: ç¼–ç æ ¼å¼chunkä¸ºå­—ç¬¦ä¸²æ—¶æœ‰ç”¨ï¼Œå¯é€‰</li>
<li>callback: å†™å…¥æˆåŠŸåçš„å›è°ƒ</li>
</ul>
<blockquote>
<p>è¿”å›å€¼ä¸ºå¸ƒå°”å€¼ï¼Œç³»ç»Ÿç¼“å­˜åŒºæ»¡æ—¶ä¸ºfalse,æœªæ»¡æ—¶ä¸ºtrue</p>
</blockquote>
<h4 id="end-æ–¹æ³•">end() æ–¹æ³•</h4>
<p><code>ws.end(chunk,[encoding],[callback])</code><br>
å¯ä»¥åœ¨å…³é—­æµä¹‹å‰å†å†™å…¥ä¸€æ®µæ•°æ® å¦‚æœä¼ å…¥äº†å¯é€‰çš„ callback å‡½æ•°ï¼Œå®ƒå°†ä½œä¸º 'finish' äº‹ä»¶çš„å›è°ƒå‡½æ•°;</p>
<h4 id="drain-æ–¹æ³•">drain() æ–¹æ³•</h4>
<ul>
<li>å½“æµä¸å¤„åœ¨drainçŠ¶æ€æ—¶ï¼Œå¯¹write()çš„è°ƒç”¨ä¼šç¼“å­˜æ•°æ®å—ï¼Œè¿”å›false;å½“å‰æ‰€æœ‰ç¼“å­˜çš„æ•°æ®å—éƒ½æ¸…ç©ºåï¼Œä¼šè§¦å‘drain()äº‹ä»¶ï¼›</li>
</ul>
<pre><code class="language-javascript">
let fs = require('fs');
let ws = fs.createWriteStream('./demo.md',{
  flags:'w',
  encoding:'utf8',
  highWaterMark:3
});
let i = 10;
function write(){
 let  flag = true;
 while(i&amp;&amp;flag){
      flag = ws.write(&quot;1&quot;);
      i--;
     console.log(flag);
 }
}
write();
ws.on('drain',()=&gt;{
  console.log(&quot;drain&quot;);
  write();
});

</code></pre>
<h4 id="finish-æ–¹æ³•">finish() æ–¹æ³•</h4>
<p>åœ¨è°ƒç”¨äº† stream.end() æ–¹æ³•ï¼Œä¸”ç¼“å†²åŒºæ•°æ®éƒ½å·²ç»ä¼ ç»™åº•å±‚ç³»ç»Ÿä¹‹åï¼Œ 'finish' äº‹ä»¶å°†è¢«è§¦å‘ã€‚</p>
<pre><code class="language-javascript">
for (let i = 0; i &lt; 100; i++) {
  ws.write(`hello, ${i}!\n`);
}
ws.end('ç»“æŸ\n');
ws.on('finish', () =&gt; {
  console.error('æ‰€æœ‰çš„å†™å…¥å·²ç»å®Œæˆ!');
});

</code></pre>
<h3 id="å€ŸåŠ©fsæ¨¡å—æä¾›çš„å¯è¯»æµä¸å¯å†™æµæ–¹æ³•å®ç°æ‹·è´">å€ŸåŠ©fsæ¨¡å—æä¾›çš„å¯è¯»æµä¸å¯å†™æµæ–¹æ³•å®ç°æ‹·è´</h3>
<pre><code class="language-javascript">
const fs = require('fs')
let readStream = fs.createReadStream('./3.fs.js', { highWaterMark: 4 })
let writeStream = fs.createWriteStream('./demo.js', { highWaterMark: 2 })
readStream.pipe(writeStream)

</code></pre>
<h2 id="æ–‡ä»¶å¯è¯»æµçš„ç®€å•å®ç°">æ–‡ä»¶å¯è¯»æµçš„ç®€å•å®ç°</h2>
<pre><code class="language-javascript">
const fs = require('fs');
const EventEmitter = require('events')
class ReadStream extends EventEmitter {
  constructor(path, options = {}) {
    super()
    this.path = path;
    this.flags = options.flags || 'r';
    this.encoding = options.encoding || null;
    if (typeof options.autoClose == &quot;undefined&quot;) {
      this.autoClose = true
    } else {
      this.autoClose = options.autoClose
    }
    this.start = options.start || 0;
    this.end = options.end || undefined;
    this.highWaterMark = options.highWaterMark || 64 * 1024;
    this.open(); // é»˜è®¤å°±è°ƒç”¨å¼€å¯äº‹ä»¶
    this.offset = this.start; // offset å¯ä»¥æ ¹æ®æ¯æ¬¡è¯»å–çš„ä½ç½®å‘ç”Ÿå˜åŒ– 
    this.flowing = false; // é»˜è®¤å°±æ˜¯éæµåŠ¨æ¨¡å¼
    this.on('newListener', (type) =&gt; {
      if (type == 'data') { // è¯´æ˜ç”¨æˆ·ç›‘å¬äº†dataäº‹ä»¶
        this.flowing = true;

        this.read(); // è¯»å–å§
      }
    });
  }
  pipe(ws) {
    this.on('data', (chunk) =&gt; {
      let flag = ws.write(chunk);
      if (!flag) {
        this.pause();
      }
    })
    ws.on('drain', () =&gt; {
      this.resume();
    })
  }
  pause() {
    this.flowing = false;
  }
  resume() {
    if (!this.flowing) {
      this.flowing = true;
      this.read(); // ç»§ç»­è¯»å–
    }
  }
  open() {
    fs.open(this.path, this.flags, (err, fd) =&gt; {
      if (err) {
        return this.emit('error', err)
      }
      this.fd = fd; // å°†æ–‡ä»¶æè¿°ç¬¦ä¿å­˜èµ·æ¥
      this.emit('open', fd)
    })
  }
  read() {
    if (typeof this.fd != 'number') { // ä¿è¯fd ä¸€å®šå­˜åœ¨ï¼Œä¸èƒ½å­˜åœ¨å°±ç­‰ä¼š ä»€ä¹ˆæ—¶å€™å­˜åœ¨å†ç”¨ 
      return this.once('open', () =&gt; this.read())
    }
    // fd ä¸€å®šå­˜åœ¨äº†, bufferæ˜¯å†…å­˜ å†…å­˜æ˜¯å¼•ç”¨ç±»å‹

    const buffer = Buffer.alloc(this.highWaterMark);
    let howMuchToRead = this.end ? Math.min((this.end - this.offset + 1), this.highWaterMark) : this.highWaterMark; // çœŸæ­£è¦è¯»å–çš„ä¸ªæ•°
    fs.read(this.fd, buffer, 0, howMuchToRead, this.offset, (err, bytesRead) =&gt; { // çœŸæ­£è¯»å–åˆ°çš„ä¸ªæ•°
      if (bytesRead) {
        this.offset += bytesRead; // æ¯æ¬¡è¯»åˆ°åå°±ç´¯åŠ ,æ–¹ä¾¿ä¸‹æ¬¡ç»§ç»­è¯»å–
        this.emit('data', buffer.slice(0, bytesRead))
        if (this.flowing) {
          this.read();
        }
      } else {
        this.emit('end');
        if (this.autoClose) {
          fs.close(this.fd, () =&gt; {
            this.emit('close');
          })
        }
      }
    })
  }
}
module.exports = ReadStream;

fs.createReadStream = function(path, options) {
  return new ReadStream(path, options);
};

</code></pre>
<h2 id="æ–‡ä»¶å¯å†™æµçš„ç®€å•å®ç°">æ–‡ä»¶å¯å†™æµçš„ç®€å•å®ç°</h2>
<ul>
<li>ç”¨é“¾è¡¨å¯ä»¥å®ç°æ ˆæˆ–è€…é˜Ÿåˆ—ï¼Œ ä»å¤´éƒ¨è·å–æ•°æ®æ€§èƒ½è¾ƒé«˜ï¼›</li>
<li>ç¬¬ä¸€æ¬¡å†™å…¥æ“ä½œæ˜¯å‘æ–‡ä»¶ä¸­å†™å…¥ ï¼Œåç»­çš„æ“ä½œéƒ½ç¼“å­˜åˆ°é“¾è¡¨ä¸­ï¼›</li>
</ul>
<pre><code class="language-javascript">
const EventEmitter = require('events');
const fs = require('fs');
const Queue = require('./Queue');
class WriteStream extends EventEmitter {
  constructor(path, options = {}) {
    super(options);
    this.path = path;
    this.flags = options.flags || 'w';
    this.encoding = options.encoding || 'utf8';
    this.autoClose = options.autoClose || true;
    this.highWaterMark = options.highWaterMark || 16 * 1024;
    this.open();

    // è¦åˆ¤æ–­æ˜¯ç¬¬ä¸€æ¬¡å†™å…¥ è¿˜æ˜¯ç¬¬äºŒæ¬¡å†™å…¥
    this.writing = false; // ç”¨æ¥æè¿°å½“å‰æ˜¯å¦æœ‰æ­£åœ¨å†™å…¥çš„æ“ä½œ
    this.len = 0; // éœ€è¦çš„ç»Ÿè®¡çš„é•¿åº¦
    this.needDrain = false;// é»˜è®¤æ˜¯å¦è§¦å‘drainäº‹ä»¶
    this.offset = 0; // æ¯æ¬¡å†™å…¥æ—¶çš„åç§»é‡
    this.cache = new Queue// ç”¨æ¥å®ç°ç¼“å­˜çš„
  }
  write(chunk, encoding = this.encoding, cb = () =&gt; { }) { // ç”¨æˆ·è°ƒç”¨çš„writeæ–¹æ³•
    // åˆ¤æ–­æ—¶çœŸçš„å†™å…¥ è¿˜æ˜¯æ”¾åˆ°ç¼“å­˜ä¸­
    // ç”¨æˆ·è°ƒç”¨writeæ—¶ å†™å…¥çš„æ•°æ®å¯èƒ½æ—¶stringOrBuffer
    chunk = Buffer.isBuffer(chunk) ? chunk : Buffer.from(chunk)
    this.len += chunk.length;
    let ret = this.len &lt; this.highWaterMark;
    if (!ret) { // è¾¾åˆ°é¢„æœŸæˆ–è€…è¶…è¿‡é¢„æœŸ å°±æ”¹å˜è§¦å‘drianäº‹ä»¶
      this.needDrain = true;
    }
    if (this.writing) { // å¦‚æœæ­£åœ¨å†™å…¥å°±å…ˆå­˜èµ·æ¥ ç¨åå†å»å†™å…¥
      this.cache.offer({ //f
        chunk,
        encoding,
        cb
      })
    } else {
      this.writing = true;// æ ‡è¯†ä¸ºæ­£åœ¨å†™å…¥
      this._write(chunk, encoding, () =&gt; { // z
        cb(); // ç”¨æˆ·æœ¬æ¥çš„å›è°ƒè¦æ‰§è¡Œ
        this.clearBuffer();
      });
    }
    return ret
  }
  clearBuffer() { // å¯¹ä¸ªå¼‚æ­¥å¹¶å‘ å¯ä»¥è€ƒé˜Ÿåˆ—æ¥å®ç° ä¾æ¬¡æ¸…ç©º
    let data = this.cache.poll();
    if (data) {
      let { chunk, encoding, cb } = data;
      this._write(chunk, encoding, () =&gt; {
        cb();
        this.clearBuffer();
      })
    } else {
      this.writing = false;// ç¼“å­˜ä¸­çš„å†…å®¹ä¹Ÿå†™å…¥äº† æ¸…ç©ºç¼“å­˜
      if (this.needDrain) {
        this.needDrain = false;
        this.emit('drain');
      }
    }
  }
  open() {
    fs.open(this.path, this.flags, (err, fd) =&gt; {
      if (err) return this.emit('error', err);
      this.fd = fd;
      this.emit('open', fd);
    })
  }
  _write(chunk, encoding, cb) { // fs.write =&gt; doWrite
    if (typeof this.fd !== 'number') {
      return this.once('open', () =&gt; this._write(chunk, encoding, cb))
    }
    fs.write(this.fd, chunk, 0, chunk.length, this.offset, (err, written) =&gt; {
      this.len -= written;
      this.offset += written;
      cb();
    })
  }
}
module.exports = WriteStream

fs.createWriteStream = function(path, options) {
  return new WriteStream(path, options);
};

// å®ç°è¯»ä¸€ç‚¹ ï¼ˆon('data') on('end') pause resumeï¼‰ å†™ä¸€ç‚¹   (write,end)

</code></pre>
<h2 id="æ‰‹å†™å®ç°ä¸€ä¸ªé“¾è¡¨">æ‰‹å†™å®ç°ä¸€ä¸ªé“¾è¡¨</h2>
<pre><code class="language-javascript">
class Node {
    constructor(element, next) {
        this.element = element;
        this.next = next;
    }
}
class LinkedList {
    constructor() {
        this.head = null;
        this.size = 0;
    }
    add(index, element) { // å¢åŠ èŠ‚ç‚¹
        if (arguments.length == 1) {
            element = index;
            index = this.size
        }
        if (index &lt; 0 || index &gt; this.size) throw new Error('é“¾è¡¨ç´¢å¼•å¼‚å¸¸');

        if (index == 0) {
            let head = this.head; // è€çš„å¤´
            this.head = new Node(element, head);
        } else {
            let prevNode = this.getNode(index - 1); // è¿™é‡Œå‰é¢èŠ‚ç‚¹è‚¯å®šæœ‰ï¼Œå¦‚æœæ²¡æœ‰ä¼šèµ°if
            prevNode.next = new Node(element, prevNode.next);
        }
        this.size++;
    }
    remove(index) { // åˆ é™¤èŠ‚ç‚¹
        if(this.size == 0) return null
        let oldNode;
        if (index == 0) {
            oldNode = this.head;
            this.head = oldNode &amp;&amp; oldNode.next;
        } else {
            let prevNode = this.getNode(index-1); // è·å–å½“å‰çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ 
            oldNode = prevNode.next; // å‰ä¸€ä¸ªçš„ä¸‹ä¸€ä¸ªå°±æ˜¯è¦åˆ é™¤çš„ 
            prevNode.next = oldNode.next; // è®©å‰ä¸€ä¸ªä¸‹ä¸€ä¸ª æ‰§è¡Œ ä¹‹å‰çš„ä¸‹ä¸€ä¸ª
        }
        this.size--;
        return oldNode.element; // è¿”å›åˆ é™¤å…ƒç´ 
    }
    getNode(index) { // è·å–èŠ‚ç‚¹
        let current = this.head; // ä»å¤´æ‰¾
        for (let i = 0; i &lt; index; i++) {
            current = current.next;
        }
        return current;
    }
    length() { // é“¾è¡¨çš„æ€»ä¸ªæ•°
        return this.size
    }
    reverseLinkedList2(){
        function reverse(head){ // å…ˆé€’å½’æœ€é‡Œé¢çš„ï¼Œåœ¨å‡ºæ¥
            // å¦‚æœé“¾è¡¨ä¸ºç©º æˆ–è€…æ²¡æœ‰ä¸‹ä¸€ä¸ªäº† å°±ä¸ç”¨åè½¬äº†
            if(head == null || head.next == null) return head;
            let newHead = reverse(head.next); // å°†åŸæ¥çš„ä¸‹ä¸€ä¸ªå˜æˆå¤´ç»“ç‚¹
            head.next.next = head; // è®©ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªæŒ‡å‘åŸæ¥çš„å¤´
            head.next = null; // è®©è€å¤´æŒ‡å‘null
            return newHead
        }   
        this.head = reverse(this.head)
        return this.head;
    }
    reverseLinkedList(){
        let head = this.head; // ä¿ç•™è€å¤´
        if(head == null || head.next == null) return head;
        let newHead = null; // æ–°çš„é“¾è¡¨å¤´éƒ¨é»˜è®¤æŒ‡å‘null
        while(head!==null){ // å¾ªç¯è€çš„é“¾è¡¨ å°†å†…å®¹ä¾æ¬¡çš„å–å‡ºä½¿ç”¨
            let temp = head.next; // å­˜å‚¨çš„æ˜¯100 
            head.next = newHead;  // è®©è€çš„å¤´æŒ‡å‘æ–°çš„å¤´
            newHead = head; // æ–°çš„å¤´æŒ‡å‘äº†è€çš„å¤´ 
            head = temp; // è€çš„å¤´å‘åç§»åŠ¨
        }
        this.head = newHead;
        return this.head
    }
}
module.exports = LinkedList

</code></pre>
<h2 id="åŸºäºé“¾è¡¨å°è£…é˜Ÿåˆ—">åŸºäºé“¾è¡¨å°è£…é˜Ÿåˆ—</h2>
<pre><code class="language-javascript">
let LinkedList = require('./LinkedList');
class Queue{ // é˜Ÿåˆ—æ˜¯æ·»åŠ å’Œåˆ é™¤
    constructor(){
        this.ll = new LinkedList();
    }
    offer(element){ // å…¥é˜Ÿåˆ—
        this.ll.add(element);
    }
    poll(){
        return this.ll.remove(0);
    }
}
module.exports = Queue;

</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Nodeç³»åˆ—ä¹‹è®¤è¯†Buffer]]></title>
        <id>https://feiyayshx.github.io/web-architecture/post/node-buffer/</id>
        <link href="https://feiyayshx.github.io/web-architecture/post/node-buffer/">
        </link>
        <updated>2020-09-22T15:16:15.000Z</updated>
        <summary type="html"><![CDATA[<p>ğŸ‘‰Buffer å¯¹è±¡ç”¨äºè¡¨ç¤ºå›ºå®šé•¿åº¦çš„å­—èŠ‚åºåˆ—ï¼›<br>
â­ï¸Buffer ç±»æ˜¯JavaScript çš„Unit8Array ç±»çš„å­ç±»ï¼Œå…¨å±€å˜é‡ï¼›</p>
]]></summary>
        <content type="html"><![CDATA[<p>ğŸ‘‰Buffer å¯¹è±¡ç”¨äºè¡¨ç¤ºå›ºå®šé•¿åº¦çš„å­—èŠ‚åºåˆ—ï¼›<br>
â­ï¸Buffer ç±»æ˜¯JavaScript çš„Unit8Array ç±»çš„å­ç±»ï¼Œå…¨å±€å˜é‡ï¼›</p>
<!-- more -->
<h2 id="1-buffer-ä¸å­—ç¬¦ç¼–ç ">1. Buffer ä¸å­—ç¬¦ç¼–ç </h2>
<p>å­—ç¬¦ç¼–ç ï¼š</p>
<ul>
<li>ASCIIç¼–ç </li>
<li>Unicode</li>
<li>UTF-8</li>
<li>GBK</li>
<li>GB2322</li>
<li>GB18030</li>
</ul>
<blockquote>
<p>ä¸€ä¸ªå­—èŠ‚ç”±8ä¸ªä½ç»„æˆï¼Œgbkä¸­ä¸€ä¸ªæ±‰å­—2ä¸ªå­—èŠ‚ï¼Œutf8ä¸­ä¸€ä¸ªæ±‰å­—3ä¸ªå­—èŠ‚</p>
</blockquote>
<p>Buffer ä¸å­—ç¬¦ä¸²ä¹‹é—´è½¬æ¢å¯ä»¥æŒ‡å®šå­—ç¬¦ç¼–ç ï¼Œå¦‚æœæœªæŒ‡å®šï¼Œé»˜è®¤æ˜¯ UTF-8ï¼›<br>
Nodeæ”¯æŒä¸¤ç§äºŒè¿›åˆ¶è½¬æ–‡æœ¬çš„ç¼–ç ï¼šbase64ã€hex; ä¸æ”¯æŒGBKç¼–ç </p>
<pre><code class="language-javascript">
let buffer = Buffer.from('hello node','utf8')
console.log(buffer.toString('base64'))

</code></pre>
<h2 id="2-bufferçš„ä¸‰ç§å®šä¹‰æ–¹æ³•">2. Bufferçš„ä¸‰ç§å®šä¹‰æ–¹æ³•</h2>
<ul>
<li>Buffer å£°æ˜åå¤§å°å›ºå®šï¼Œä¸å¯éšæ„æ›´æ”¹å¤§å°ï¼Œå¯ä»¥å†å£°æ˜ä¸€ä¸ªç©ºé—´å°†ç»“æœæ‹·è´è¿›å»ï¼›</li>
<li>å¯ä»¥é€šè¿‡ç´¢å¼•æ›´æ”¹bufferå†…å®¹ï¼›</li>
</ul>
<pre><code class="language-javascript">
// buffer1å£°æ˜çš„å­—èŠ‚æ•°æ˜¯4ï¼Œ&lt;Buffer 00 00 00 00&gt;
let buffer1 = Buffer.alloc(4) 

// buffer2çš„é•¿åº¦æ˜¯9ä¸ªå­—èŠ‚ï¼Œ&lt;Buffer e5 a4 a7 e5 89 8d e7 ab af&gt;
let buffer2 = Buffer.from('å¤§å‰ç«¯') 

// buffer3é•¿åº¦æ˜¯arrayçš„å…ƒç´ æ•°ç›®ï¼Œ&lt;Buffer 01 02 03 04&gt;
let buffer3 = Buffer.from([1, 2, 3, 4]) 

</code></pre>
<h2 id="3-bufferçš„å¸¸ç”¨æ–¹æ³•">3. Bufferçš„å¸¸ç”¨æ–¹æ³•</h2>
<pre><code class="language-javascript">
buff.toString()
buff.fill()
buff.slice()
buff.copy
Buffer.concat()
Buffer.isBuffer()

</code></pre>
<p><strong>Buffer.concat() æ–¹æ³•çš„å®ç°</strong></p>
<pre><code class="language-javascript">
Buffer.concat = function (bufferList, length = bufferList.reduce((a,b)=&gt;a+b.length,0) {
    let buf = Buffer.alloc(length);
    let offset = 0
    bufferList.forEach(bufItem =&gt; {
        bufItem.copy(buf,offset);
        offset += bufItem.length;
    });
    return buf.slice(0,offset)
}

/* ç”¨æ³• */
let buffer1 = Buffer.from('å–œé©¬æ‹‰é›…');
let buffer2 = Buffer.from('hello');
const newBuffer = Buffer.concat([buffer1,buffer2],20)
console.log(newBuffer)
console.log(Buffer.isBuffer(newBuffer))

</code></pre>
<p><strong>buf.copy() æ–¹æ³•çš„å®ç°</strong></p>
<p><code>buf.copy(target,targetStart,sourceStart,sourceEnd)</code></p>
<ul>
<li><code>target</code>: è¦æ‹·è´è¿›çš„Buffer</li>
<li><code>targetStart</code>: target ä¸­å¼€å§‹å†™å…¥ä¹‹å‰è¦è·³è¿‡çš„å­—èŠ‚æ•°; é»˜è®¤å€¼: 0ã€‚</li>
<li><code>sourceStart</code>: buf ä¸­å¼€å§‹æ‹·è´çš„åç§»é‡; é»˜è®¤å€¼: 0ã€‚</li>
<li><code>sourceEnd</code>: buf ä¸­ç»“æŸæ‹·è´çš„åç§»é‡ï¼ˆä¸åŒ…å«ï¼‰; é»˜è®¤å€¼: buf.lengthã€‚</li>
</ul>
<pre><code class="language-javascript">
Buffer.prototype.copy = function(targetBuffer,targetStart,sourceStart,sourceEnd){
  for(let i=sourceStart;i&lt;sourceEnd;i++){
    targetBuffer[targetStart++]=this[i];
  }
}

/* ç”¨æ³• */
var buf = Buffer.alloc(12);
var buffer1 = Buffer.from('å¤©å¤©');
var buffer2 = Buffer.from('å‘ä¸Š');
buffer1.copy(buf, 0, 0, 6)
buffer2.copy(buf, 6, 0, 6)
console.log(buf)

</code></pre>
<p><strong>buf.split() æ–¹æ³•çš„å®ç°</strong></p>
<p><code>buf.split(separator)</code></p>
<ul>
<li><code>separator</code>: åˆ†éš”ç¬¦ï¼Œå°†buffer æŒ‰åˆ†éš”ç¬¦åˆ†å‰²ç»„è£…æˆæ•°ç»„</li>
</ul>
<pre><code class="language-javascript">
Buffer.prototype.split = function(sep){ // slice + indexOf = split
  let arr = [];
  let len = Buffer.from(sep).length; //  åˆ†å‰²ç¬¦å·çš„é•¿åº¦
  let offset = 0;
  let current;
  while(-1!=(current = this.indexOf(sep,offset))){
      // æ‰¾åˆ°çš„ä½ç½® åŠ ä¸Šåç§»é‡
      arr.push(this.slice(offset,current));
      offset = current+len;
  }
  arr.push(this.slice(offset));
  return arr;
}

/* ç”¨æ³• */
let buffer = Buffer.from('hello&amp;node&amp;js','utf8')
let bufArr = buffer.split('&amp;')

// [ &lt;Buffer 68 65 6c 6c 6f&gt;, &lt;Buffer 6e 6f 64 65&gt;, &lt;Buffer 6a 73&gt; ]
console.log(bufArr) 

// è¿­ä»£buffer
for(let item of bufArr) {
    // hello node js
  console.log(item.toString())
}

</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Javascriptä¹‹è¿›åˆ¶è½¬æ¢]]></title>
        <id>https://feiyayshx.github.io/web-architecture/post/decimal-binary-conversion/</id>
        <link href="https://feiyayshx.github.io/web-architecture/post/decimal-binary-conversion/">
        </link>
        <updated>2020-09-17T04:49:50.000Z</updated>
        <summary type="html"><![CDATA[<p>ğŸ‘‡Javascriptä¸­çš„è¿›åˆ¶è½¬æ¢æ–¹æ³•ï¼š<code>toString()</code>ã€<code>parseInt()</code></p>
]]></summary>
        <content type="html"><![CDATA[<p>ğŸ‘‡Javascriptä¸­çš„è¿›åˆ¶è½¬æ¢æ–¹æ³•ï¼š<code>toString()</code>ã€<code>parseInt()</code></p>
<!-- more -->
<h2 id="1-åè¿›åˆ¶è½¬å…¶ä»–è¿›åˆ¶">1. åè¿›åˆ¶è½¬å…¶ä»–è¿›åˆ¶</h2>
<ul>
<li><code>toString(radix)</code>
<ul>
<li><code>radix</code> &lt;Number&gt;  è¿›åˆ¶å¯¹åº”çš„åŸºæ•°</li>
</ul>
</li>
</ul>
<pre><code class="language-javascript">
let x= 20
x.toString(2)   // è½¬ä¸ºäºŒè¿›åˆ¶ï¼š10100
x.toString(8)   // è½¬ä¸ºå…«è¿›åˆ¶ï¼š24
x.toString(16)  // è½¬ä¸ºåå…­è¿›åˆ¶ï¼š14
20.0.toString(16) // è½¬ä¸ºåå…­è¿›åˆ¶ï¼š14
</code></pre>
<h2 id="2-å…¶ä»–è¿›åˆ¶è½¬åè¿›åˆ¶">2. å…¶ä»–è¿›åˆ¶è½¬åè¿›åˆ¶</h2>
<ul>
<li><code>parseInt(value,radix)</code>
<ul>
<li><code>value</code>  &lt;String&gt; å…¶ä»–è¿›åˆ¶çš„å€¼ï¼Œæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²</li>
<li><code>radix</code>  &lt;Number&gt; åŸºæ•°</li>
</ul>
</li>
</ul>
<pre><code class="language-javascript">
parseInt('10100',2)    // 2è¿›åˆ¶è½¬åè¿›åˆ¶:20
parseInt('024',8)   //  8è¿›åˆ¶è½¬åè¿›åˆ¶:20
parseInt('0x14',16)   //  16è¿›åˆ¶è½¬åè¿›åˆ¶:20
</code></pre>
<h2 id="3-åè¿›åˆ¶å°æ•°è½¬äºŒè¿›åˆ¶å°æ•°">3. åè¿›åˆ¶å°æ•°è½¬äºŒè¿›åˆ¶å°æ•°</h2>
<p>JSæµ®ç‚¹æ•°åˆ†æ•´æ•°å’Œå°æ•°ä¸¤éƒ¨åˆ†ï¼›è¿™é‡Œä»¥25.75ä¸¾ä¾‹è¯´æ˜ï¼š<br>
ï¼ˆ1ï¼‰å°†æ•´æ•°25è½¬ä¸ºäºŒè¿›åˆ¶ï¼šé‡‡å–é™¤2å–ä½™ï¼Œç›´åˆ°é™¤æ•°ä¸º0,æœ€åå°†ä½™æ•°é€†åºæ’åˆ—ï¼›</p>
<pre><code class="language-javascript">
25/2=12 ...1
12/2=6 ...0
6/2=3 ...0
3/2=1 ...1
1/2=0 ...1
</code></pre>
<p><em>æ•…æ•´æ•°éƒ¨åˆ†äºŒè¿›åˆ¶å€¼ä¸ºï¼š11001</em></p>
<p>ï¼ˆ2ï¼‰å°†å°æ•°éƒ¨åˆ†0.75è½¬ä¸ºäºŒè¿›åˆ¶ï¼šé‡‡å–ä¹˜2å–æ•´ï¼Œç›´åˆ°ä¹˜ç§¯ç»“æœä¸º1ï¼Œæœ€åå°†æ•´æ•°é¡ºåºæ’åˆ—ï¼›</p>
<pre><code class="language-javascript">
0.75*2=1.5 ...1
0.5*2=1 ...1
</code></pre>
<p><em>æ•…å°æ•°éƒ¨åˆ†äºŒè¿›åˆ¶å€¼ä¸ºï¼š11</em></p>
<p><strong>å› æ­¤æµ®ç‚¹æ•°25.75çš„äºŒè¿›åˆ¶å€¼ä¸º11001.11</strong></p>
<h2 id="4-äºŒè¿›åˆ¶å°æ•°ä¸¢å¤±ç²¾åº¦å¯¼è‡´çš„é—®é¢˜">4. äºŒè¿›åˆ¶å°æ•°ä¸¢å¤±ç²¾åº¦å¯¼è‡´çš„é—®é¢˜</h2>
<p>ä¸¾ä¾‹è¯´æ˜ï¼š<code>0.1 + 0.2 ï¼= 0.3</code>,  js è®¡ç®—æ—¶ å°†0.1ï¼Œ0.2åˆ†åˆ«è½¬ä¸ºäºŒè¿›åˆ¶ï¼›è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<pre><code class="language-javascript">
// 0.1 è½¬ä¸ºäºŒè¿›åˆ¶è®¡ç®—è¿‡ç¨‹
0.1 * 2 = 0.2    0
0.2 * 2 = 0.4    0
0.4 * 2 = 0.8    0
0.8 * 2 = 1.6    1  =&gt; 0.6
0.6 * 2 = 1.2    1  =&gt; 0.2
0.2 * 2 = 0.4    0 // å‡ºç°æ— é™å¾ªç¯
0.4 * 2 = 0.8    0
0.8 * 2 = 1.6    1
0.6 * 2 = 1.2    1
0.2 * 2 = 0.4    0
...
// 0.2 è½¬ä¸ºäºŒè¿›åˆ¶è®¡ç®—è¿‡ç¨‹
0.2 * 2 = 0.4    0
0.4 * 2 = 0.8    0
0.8 * 2 = 1.6    1
0.6 * 2 = 1.2    1
0.2 * 2 = 0.4    0
0.4 * 2 = 0.8    0
0.8 * 2 = 1.6    1  // å‡ºç°æ— é™å¾ªç¯
...
</code></pre>
<p>0.1 -&gt;  0.000110011001.....<br>
0.2 -&gt; 0.001100110011......<br>
å› ä¸ºjs çš„æ•°å­—æ˜¯é‡‡ç”¨IEEE754æ ‡å‡†çš„64ä½åŒç²¾åº¦æµ®ç‚¹æ•°è¿›è¡Œå­˜å‚¨ï¼Œå°æ•°éƒ¨åˆ†æœ€å¤šæ”¯æŒ53ä½äºŒè¿›åˆ¶ä½ï¼Œæ‰€ä»¥æ— é™å¾ªç¯çš„å°æ•°äºŒè¿›åˆ¶ä½ä¼šè¢«èˆå»ï¼›<br>
<strong>æ•…0.1 + 0.3 è¿‘ä¼¼ç­‰äº 0.30000000000000004</strong></p>
<h2 id="5-jsä¸­çš„å®‰å…¨æ•°">5. JSä¸­çš„å®‰å…¨æ•°</h2>
<ol>
<li>å°¾æ•°éƒ¨åˆ†ï¼š0-51 bitï¼Œå†³å®šæ•°å€¼çš„ç²¾åº¦</li>
<li>æŒ‡æ•°éƒ¨åˆ†ï¼š52-62 bit ,å†³å®šæ•°å€¼çš„å¤§å°</li>
<li>ç¬¦å·ä½ï¼š63bit, å†³å®šæ•°å€¼çš„æ­£è´Ÿï¼›0è¡¨ç¤ºæ­£æ•°ï¼Œ1è¡¨ç¤ºè´Ÿæ•°ï¼›</li>
</ol>
<h2 id="6-base64-ç¼–ç ">6. base64 ç¼–ç </h2>
<p>ASCIIç  æ˜¯å¯¹è‹±æ–‡å­—ç¬¦ç¼–ç çš„ä¸€ç§ç¼–ç æ–¹å¼ï¼Œä½¿ç”¨ä¸€ä¸ªå­—èŠ‚(8 bit)ç¼–ç è‹±æ–‡å­—ç¬¦ï¼›<br>
base64æ˜¯é€‰å‡º64ä¸ªå­—ç¬¦ä½œä¸ºåŸºæœ¬å­—ç¬¦é›†ï¼Œå…¶ä»–æ‰€æœ‰ç¬¦å·éƒ½è½¬æ¢æˆè¿™ä¸ªå­—ç¬¦é›†ä¸­çš„å­—ç¬¦ï¼›<br>
<strong>è¿™64ä¸ªå­—ç¬¦åŒ…æ‹¬ï¼ša-zã€A-Zã€0-9ã€+ã€/</strong></p>
<ul>
<li>base64 ç¼–ç è¿‡ç¨‹ï¼š
<ul>
<li>step1: å°†æ¯ä¸‰ä¸ªå­—èŠ‚åˆ†ä¸ºä¸€ç»„ï¼Œä¸€ä¸ªå­—èŠ‚æœ‰8ä¸ªäºŒè¿›åˆ¶ä½ï¼Œä¸€å…±æœ‰24ä¸ªäºŒè¿›åˆ¶ä½ï¼›</li>
<li>step2: å†å°†è¿™24ä¸ªäºŒè¿›åˆ¶ä½é‡æ–°åˆ†ä¸ºå››ç»„ï¼Œæ¯ç»„æœ‰6ä¸ªäºŒè¿›åˆ¶ä½ï¼›</li>
<li>step3: åœ¨æ¯ç»„å‰é¢è¡¥ä¸¤ä¸ª0ï¼Œæ‰©å±•æˆ32ä¸ªäºŒè¿›åˆ¶ä½ï¼Œå³å››ä¸ªå­—èŠ‚ï¼›</li>
<li>setp4: æ ¹æ®ä¸‹è¡¨æ˜ å°„ï¼Œå¾—åˆ°æ‰©å±•åæ¯ä¸ªå­—èŠ‚å¯¹åº”çš„ç¬¦å·ï¼Œå°±æ˜¯æœ€ç»ˆçš„base64ç¼–ç å€¼ã€‚</li>
</ul>
</li>
</ul>
<blockquote>
<p>A-0  B-1  C-2  D-3  E-4  F-5  G-6  H-7  I-8  J-9  K-10  L-11  M-12  N-13  O-14  P-15  Q-16  R-17  S-18  T-19  U-20  V-21  W-22  X-23  Y-24  Z-25<br>
a-26  b-27  c-28  d-29  e-30  f-31  g-32  h-33 i-34  j-35  k-36  l-37  m-38  n-39  o-40  p-41  q-42  r-43  s-44  t-45  u-46  v-47 w-48 x-49  y-50  z-51<br>
0-52 1-53  2-54 3-55 4-56  5-57 6-58  7-59  8-60 9-61 +-62 /-63</p>
</blockquote>
<h3 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </h3>
<p><a href="http://www.ruanyifeng.com/blog/2008/06/base64.html">Base64ç¬”è®°</a></p>
]]></content>
    </entry>
</feed>