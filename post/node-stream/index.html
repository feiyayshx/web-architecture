<html>

<head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>
    Nodeç³»åˆ—ä¹‹streamæ¨¡å— | å¢¨çœ‰
</title>
<link rel="shortcut icon" href="https://feiyayshx.github.io/web-architecture/favicon.ico?v=1603177989719">
<!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous"> -->
<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://feiyayshx.github.io/web-architecture/styles/main.css">
<!-- js -->
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<script src="https://feiyayshx.github.io/web-architecture/media/js/jquery.sticky-sidebar.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>


        
</head>

<body>
    <div class="main">
        <div class="header">
    <div class="nav">
        <div class="logo">
            <a href="https://feiyayshx.github.io/web-architecture">
                <img class="avatar" src="https://feiyayshx.github.io/web-architecture/images/avatar.png?v=1603177989719" alt="">
            </a>
            <div class="site-title">
                <h1>
                    å¢¨çœ‰
                </h1>
            </div>
        </div>
        <span class="menu-btn fa fa-align-justify"></span>
        <div class="menu-container">
            <ul>
                
                    
                        <li>
                            <a href="https://feiyayshx.github.io/web-architecture" class="menu" target="_blank">
                                é¦–é¡µ
                            </a>
                        </li>
                        
                                
                    
                            <li>
                                <a href="https://feiyayshx.github.io/web-architecture/archives" class="menu">
                                    å½’æ¡£
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="https://feiyayshx.github.io/web-architecture/tags" class="menu">
                                    æ ‡ç­¾
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="https://feiyayshx.github.io/web-architecture/post/about" class="menu">
                                    å…³äº
                                </a>
                            </li>
                            
                                
            </ul>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        $(".menu-btn").click(function() {
            $(".menu-container").slideToggle();
        });
        $(window).resize(function() {

            if (window.matchMedia('(min-width: 960px)').matches) {
                $(".menu-container").css('display', 'block')
            } else {
                $(".menu-container").css('display', 'none')
            }

        });
    });
</script>

            <div id="main-content" class="post-detail main-container">
                <!-- left -->
                <div id="content" class="main-container-left">
                    <article class="post i-card">
                        <h2 class="post-title">
                            Nodeç³»åˆ—ä¹‹streamæ¨¡å—
                        </h2>
                        <div class="post-info">
                            <time class="post-time">2020-09-28 16:04</time>
                            
                                <a href="https://feiyayshx.github.io/web-architecture/tag/node/" class="post-tag i-tag
                            i-tag-success">
                            #Node
                        </a>
                                
                        </div>
                        
                                <div class="post-content">
                                    <p>ğŸ‘ å‰è¨€ï¼š æœ¬æ–‡æ˜¯å­¦ä¹ Nodeæ—¶ï¼Œå¯¹å…¶ä¸­streamæ¨¡å—å­¦ä¹ çš„ä¸€ä¸ªç¬”è®°æ€»ç»“ï¼Œä¸»è¦æ˜¯åŠ å¼ºç†è§£ï¼</p>
<!-- more -->
<h2 id="1-æµçš„æ¦‚å¿µ">1. æµçš„æ¦‚å¿µ</h2>
<p>æµ(stream)æ˜¯node.jsä¸­å¤„ç†æµå¼æ•°æ®çš„æŠ½è±¡æ¥å£ã€‚</p>
<p>streamæ¨¡å—ç”¨äºæ„å»ºå®ç°äº†æµæ¥å£çš„å¯¹è±¡ã€‚</p>
<p>Node.js æä¾›äº†å¤šç§æµå¯¹è±¡ï¼Œä¾‹å¦‚ï¼ŒHTTP æœåŠ¡å™¨çš„è¯·æ±‚å’Œ process.stdout éƒ½æ˜¯æµçš„å®ä¾‹ã€‚</p>
<p>æµå¯ä»¥æ˜¯å¯è¯»çš„ã€å¯å†™çš„ã€æˆ–è€…å¯è¯»å¯å†™çš„ã€‚ æ‰€æœ‰çš„æµéƒ½æ˜¯ EventEmitter çš„å®ä¾‹ã€‚</p>
<h2 id="2-nodeä¸­å››ç§åŸºæœ¬çš„æµç±»å‹">2. Nodeä¸­å››ç§åŸºæœ¬çš„æµç±»å‹</h2>
<ul>
<li>
<p>Writable - å¯å†™å…¥æ•°æ®çš„æµï¼ˆä¾‹å¦‚ fs.createWriteStream()ï¼‰;</p>
</li>
<li>
<p>Readable - å¯è¯»å–æ•°æ®çš„æµï¼ˆä¾‹å¦‚ fs.createReadStream()ï¼‰;</p>
</li>
<li>
<p>Duplex - å¯è¯»åˆå¯å†™çš„æµï¼ˆä¾‹å¦‚ net.Socketï¼‰;</p>
</li>
<li>
<p>Transform - åœ¨è¯»å†™è¿‡ç¨‹ä¸­å¯ä»¥ä¿®æ”¹æˆ–è½¬æ¢æ•°æ®çš„ Duplex æµï¼ˆä¾‹å¦‚ zlib.createDeflate()ï¼‰ã€‚</p>
</li>
</ul>
<h2 id="3-æµçš„æ•°æ®æ¨¡å¼">3. æµçš„æ•°æ®æ¨¡å¼</h2>
<ul>
<li>
<p>äºŒè¿›åˆ¶æ¨¡å¼ï¼šNode.js åˆ›å»ºçš„æµéƒ½æ˜¯è¿ä½œåœ¨å­—ç¬¦ä¸²å’Œ Bufferï¼ˆæˆ– Uint8Arrayï¼‰ä¸Š;</p>
</li>
<li>
<p>å¯¹è±¡æ¨¡å¼(object mode)ï¼šå½“åˆ›å»ºæµæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ objectMode é€‰é¡¹æŠŠæµå®ä¾‹åˆ‡æ¢åˆ°å¯¹è±¡æ¨¡å¼ã€‚ å°†å·²å­˜åœ¨çš„æµåˆ‡æ¢åˆ°å¯¹è±¡æ¨¡å¼æ˜¯ä¸å®‰å…¨çš„</p>
</li>
</ul>
<h2 id="4-å¯è¯»æµçš„è¯»å–æ¨¡å¼">4. å¯è¯»æµçš„è¯»å–æ¨¡å¼</h2>
<p><strong>flowingæ¨¡å¼(æµåŠ¨æ¨¡å¼)</strong>ï¼šå¯è¯»æµè‡ªåŠ¨ä»ç³»ç»Ÿåº•å±‚è¯»å–æ•°æ®ï¼Œå¹¶é€šè¿‡EventEmitteræ¥å£çš„äº‹ä»¶å°†æ•°æ®æä¾›ç»™åº”ç”¨ï¼›</p>
<p><strong>pausedæ¨¡å¼(æš‚åœæ¨¡å¼)</strong>ï¼šå¿…é¡»æ˜¾å¼è°ƒç”¨stream.read()æ–¹æ³•ä»æµä¸­è¯»å–æ•°æ®ç‰‡æ®µï¼›</p>
<p>æ‰€æœ‰åˆå§‹å·¥ä½œæ¨¡å¼ä¸ºpausedçš„Readableæµï¼Œå¯ä»¥é€šè¿‡ä¸‰ç§æ–¹å¼åˆ‡æ¢åˆ°flowingæ¨¡å¼ï¼š</p>
<ul>
<li>ç›‘å¬dataäº‹ä»¶</li>
<li>è°ƒç”¨stream.resume()</li>
<li>è°ƒç”¨stream.pipe()æ–¹æ³•å°†æ•°æ®å‘é€åˆ°Writeable</li>
</ul>
<p>å¯è¯»æµReadableå¯é€šè¿‡ä¸‹åˆ—æ–¹å¼åˆ‡æ¢åˆ°pausedæ¨¡å¼ï¼š</p>
<ul>
<li>å¦‚æœä¸å­˜åœ¨ç®¡é“ç›®æ ‡ï¼ˆpipe destinationï¼‰ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨ stream.pause() æ–¹æ³•å®ç°ã€‚</li>
<li>å¦‚æœå­˜åœ¨ç®¡é“ç›®æ ‡ï¼Œå¯ä»¥é€šè¿‡å–æ¶ˆ 'data' äº‹ä»¶ç›‘å¬ï¼Œå¹¶è°ƒç”¨ stream.unpipe() æ–¹æ³•ç§»é™¤æ‰€æœ‰ç®¡é“ç›®æ ‡æ¥å®ç°ã€‚</li>
</ul>
<h2 id="5-å¯è¯»æµçš„ä¸‰ç§çŠ¶æ€">5. å¯è¯»æµçš„ä¸‰ç§çŠ¶æ€</h2>
<p>åœ¨ä»»æ„æ—¶åˆ»ï¼Œå¯è¯»æµåº”ç¡®åˆ‡å¤„äºä¸‹é¢ä¸‰ç§çŠ¶æ€ä¹‹ä¸€ï¼š</p>
<p><code>readable._readableState.flowing = null</code></p>
<p><code>readable._readableState.flowing = false</code></p>
<p><code>readable._readableState.flowing = true</code></p>
<ul>
<li>
<p>è‹¥<code>readable._readableState.flowing = null</code>ï¼Œç”±äºä¸å­˜åœ¨æ•°æ®æ¶ˆè´¹è€…ï¼Œå¯è¯»æµä¸ä¼šäº§ç”Ÿæ•°æ®ã€‚åœ¨æ­¤çŠ¶æ€ä¸‹ï¼Œç›‘å¬dataäº‹ä»¶ï¼Œè°ƒç”¨readable.pipe()æ–¹æ³•ï¼Œæˆ–è€…è°ƒç”¨readable.resume(),<code>readable._readableState.flowing</code>çš„å€¼å°†ä¼šå˜ä¸ºtrue, éšç€æ•°æ®ç”Ÿæˆï¼Œå¯è¯»æµå¼€å§‹é¢‘ç¹è§¦å‘äº‹ä»¶ã€‚</p>
</li>
<li>
<p>è°ƒç”¨<code>readable.pause()</code>,æˆ–è€…<code>readable.unpipe()</code>,æˆ–è€…æ¥æ”¶ â€œèƒŒå‹â€ï¼ˆback pressureï¼‰ï¼Œå°†å¯¼è‡´ readable._readableState.flowing å€¼å˜ä¸º falseã€‚è¿™å°†æš‚åœäº‹ä»¶æµï¼Œä½†ä¸ä¼šæš‚åœæ•°æ®ç”Ÿæˆï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸º 'data' äº‹ä»¶è®¾ç½®ç›‘å¬å‡½æ•°ä¸ä¼šå¯¼è‡´ <code>readable._readableState.flowing</code> å˜ä¸º trueã€‚</p>
</li>
<li>
<p>å½“ <code>readable._readableState.flowing</code> å€¼ä¸º false æ—¶ï¼Œ æ•°æ®å¯èƒ½å †ç§¯åˆ°æµçš„å†…éƒ¨ç¼“å­˜ä¸­ã€‚</p>
</li>
</ul>
<h2 id="6-ç¼“å†²">6. ç¼“å†²</h2>
<ul>
<li>
<p>å¯å†™æµå’Œå¯è¯»æµéƒ½ä¼šåœ¨å†…éƒ¨çš„ç¼“å†²å™¨ä¸­å­˜å‚¨æ•°æ®ï¼Œå¯ä»¥åˆ†åˆ«ä½¿ç”¨çš„ writable.writableBuffer æˆ– readable.readableBuffer æ¥è·å–ã€‚</p>
</li>
<li>
<p>å¯ç¼“å†²çš„æ•°æ®å¤§å°å–å†³äºä¼ å…¥æµæ„é€ å‡½æ•°çš„ highWaterMark é€‰é¡¹ã€‚ å¯¹äºæ™®é€šçš„æµï¼Œ highWaterMark æŒ‡å®šäº†å­—èŠ‚çš„æ€»æ•°ã€‚ å¯¹äºå¯¹è±¡æ¨¡å¼çš„æµï¼Œ highWaterMark æŒ‡å®šäº†å¯¹è±¡çš„æ€»æ•°ã€‚</p>
</li>
<li>
<p>å½“è°ƒç”¨ stream.push(chunk) æ—¶ï¼Œæ•°æ®ä¼šè¢«ç¼“å†²åœ¨å¯è¯»æµä¸­ã€‚ å¦‚æœæµçš„æ¶ˆè´¹è€…æ²¡æœ‰è°ƒç”¨ stream.read()ï¼Œåˆ™æ•°æ®ä¼šä¿ç•™åœ¨å†…éƒ¨é˜Ÿåˆ—ä¸­ç›´åˆ°è¢«æ¶ˆè´¹ã€‚</p>
</li>
<li>
<p>ä¸€æ—¦å†…éƒ¨çš„å¯è¯»ç¼“å†²çš„æ€»å¤§å°è¾¾åˆ° highWaterMark æŒ‡å®šçš„é˜ˆå€¼æ—¶ï¼Œæµä¼šæš‚æ—¶åœæ­¢ä»åº•å±‚èµ„æºè¯»å–æ•°æ®ï¼Œç›´åˆ°å½“å‰ç¼“å†²çš„æ•°æ®è¢«æ¶ˆè´¹ã€‚</p>
</li>
<li>
<p>å½“è°ƒç”¨ writable.write(chunk) æ—¶ï¼Œæ•°æ®ä¼šè¢«ç¼“å†²åœ¨å¯å†™æµä¸­ã€‚ å½“å†…éƒ¨çš„å¯å†™ç¼“å†²çš„æ€»å¤§å°å°äº highWaterMark è®¾ç½®çš„é˜ˆå€¼æ—¶ï¼Œè°ƒç”¨ writable.write() ä¼šè¿”å› trueã€‚ ä¸€æ—¦å†…éƒ¨ç¼“å†²çš„å¤§å°è¾¾åˆ°æˆ–è¶…è¿‡ highWaterMark æ—¶ï¼Œåˆ™ä¼šè¿”å› falseã€‚</p>
</li>
<li>
<p>Duplex å’Œ Transform éƒ½æ˜¯å¯è¯»å†™çš„ã€‚ åœ¨å†…éƒ¨ï¼Œå®ƒä»¬éƒ½ç»´æŠ¤äº† ä¸¤ä¸ª ç›¸äº’ç‹¬ç«‹çš„ç¼“å†²å™¨ç”¨äºè¯»å’Œå†™ã€‚ åœ¨ç»´æŒäº†åˆç†é«˜æ•ˆçš„æ•°æ®æµçš„åŒæ—¶ï¼Œä¹Ÿä½¿å¾—å¯¹äºè¯»å’Œå†™å¯ä»¥ç‹¬ç«‹è¿›è¡Œè€Œäº’ä¸å½±å“ã€‚</p>
</li>
<li>
<p>stream API çš„å…³é”®ç›®æ ‡ï¼Œ å°¤å…¶å¯¹äº stream.pipe() æ–¹æ³•ï¼Œ å°±æ˜¯é™åˆ¶ç¼“å†²å™¨æ•°æ®å¤§å°ï¼Œä»¥è¾¾åˆ°å¯æ¥å—çš„ç¨‹åº¦ã€‚è¿™æ ·ï¼Œå¯¹äºè¯»å†™é€Ÿåº¦ä¸åŒ¹é…çš„æºå¤´å’Œç›®æ ‡ï¼Œå°±ä¸ä¼šè¶…å‡ºå¯ç”¨çš„å†…å­˜å¤§å°ã€‚</p>
</li>
</ul>
<h2 id="7-è‡ªå®šä¹‰å¯è¯»æµ">7.  è‡ªå®šä¹‰å¯è¯»æµ</h2>
<p>ä¸ºäº†å®ç°å¯è¯»æµï¼Œç»§æ‰¿Readableæ¥å£å¹¶ç”¨å®ƒæ„é€ æ–°å¯¹è±¡</p>
<pre><code class="language-javascript">
const { Readable } = require('stream');

class MyRead extends Readable{ // é»˜è®¤ä¼šè°ƒç”¨Readableä¸­çš„readæ–¹æ³•
    _read(){
        // pushæ–¹æ³•æ˜¯Readableä¸­æä¾›çš„, è°ƒç”¨pushå°†ç»“æœæ”¾å…¥,å°±å¯ä»¥è§¦å‘ on('dataäº‹ä»¶')
        this.push('ok'); 
        // æ”¾å…¥nullè¡¨ç¤ºè¿™ä¸ªæµæ²¡æœ‰æ›´å¤šæ•°æ®äº†
        this.push(null); 
    }
}

let mr = new MyRead;
mr.on('data',function (data) {
    console.log(data);
})
mr.on('end',function () {
    console.log('end')
})
mr.on('open',function () {
    console.log('open')
})

</code></pre>
<h2 id="8-è‡ªå®šä¹‰å¯å†™æµ">8. è‡ªå®šä¹‰å¯å†™æµ</h2>
<p>è‡ªå®šä¹‰å¯å†™æµï¼Œç»§æ‰¿Writableæ¥å£æ¥æ„é€ æ–°å¯¹è±¡<br>
_write(chunk,encoding,callback)å‡½æ•°ï¼š</p>
<ul>
<li>chunké€šå¸¸æ˜¯ä¸€ä¸ªbufferï¼Œé™¤éæˆ‘ä»¬é…ç½®ä¸åŒçš„æµã€‚</li>
<li>encodingæ˜¯åœ¨ç‰¹å®šæƒ…å†µä¸‹éœ€è¦çš„å‚æ•°ï¼Œé€šå¸¸æˆ‘ä»¬å¯ä»¥å¿½ç•¥å®ƒã€‚</li>
<li>callbackæ˜¯åœ¨å®Œæˆå¤„ç†æ•°æ®å—åéœ€è¦è°ƒç”¨çš„å‡½æ•°ã€‚è¿™æ˜¯å†™æ•°æ®æˆåŠŸä¸å¦çš„æ ‡å¿—ã€‚è‹¥è¦å‘å‡ºæ•…éšœä¿¡å·ï¼Œè¯·ç”¨é”™è¯¯å¯¹è±¡è°ƒç”¨å›è°ƒå‡½æ•°</li>
</ul>
<pre><code class="language-javascript">
const { Writable } = require('stream')

class MyWrite extends Writable {
  _write(chunk, encoding, cb) {
    cb();
  }
}

let mw = new MyWrite();
mw.write('ok', function () {
  console.log('ok')
})
mw.write('ab')

</code></pre>
<h2 id="9-è‡ªå®šä¹‰åŒå·¥æµ">9. è‡ªå®šä¹‰åŒå·¥æµ</h2>
<p>åŒå·¥æµèƒ½è¯»åˆèƒ½å†™ï¼ŒåŒå·¥æµçš„å¯è¯»æ€§å’Œå¯å†™æ€§æ“ä½œå®Œå…¨ç‹¬ç«‹äºå½¼æ­¤ã€‚è¿™ä»…ä»…æ˜¯å°†ä¸¤ä¸ªç‰¹æ€§ç»„åˆæˆä¸€ä¸ªå¯¹è±¡ã€‚</p>
<pre><code class="language-javascript">
const { Duplex } = require('stream');
class MyDuplex extends Duplex{
    _read(){
        this.push('xxx');
        this.push(null)
    }
    _write(chunk,encoding,cb){
        console.log(chunk);
        cb() // clearBuffer
    }
}
let md = new MyDuplex();
md.on('data',function (chunk) {
    console.log(chunk)
})
md.write('ok');

</code></pre>
<h2 id="10-è‡ªå®šä¹‰è½¬æ¢æµ">10. è‡ªå®šä¹‰è½¬æ¢æµ</h2>
<ul>
<li>
<p>è½¬æ¢æµçš„è¾“å‡ºæ˜¯ä»è¾“å…¥ä¸­è®¡ç®—å‡ºæ¥çš„ã€‚</p>
</li>
<li>
<p>å¯¹äºè½¬æ¢æµï¼Œæˆ‘ä»¬ä¸å¿…å®ç°readæˆ–writeçš„æ–¹æ³•ï¼Œæˆ‘ä»¬åªéœ€è¦å®ç°ä¸€ä¸ªtransformæ–¹æ³•ï¼Œå°†ä¸¤è€…ç»“åˆèµ·æ¥ã€‚å®ƒæœ‰writeåŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥ç”¨å®ƒæ¥pushæ•°æ®ã€‚</p>
</li>
<li>
<p>å¯ä»¥ç”¨äºåŠ å¯†ã€å‹ç¼© ï¼Œå¯ä»¥æŠŠå¯å†™æµè½¬æ¢æˆå¯è¯»æµã€‚</p>
</li>
</ul>
<pre><code class="language-javascript">const { Transform } = require('stream');
class MyTransfrom extends Transform {
    _transform(chunk, encoding, cb) {
        // è¿™é‡Œå¯ä»¥è°ƒç”¨pushæ–¹æ³•
        this.push(chunk.toString().toUpperCase()); // this.emit()
        cb();
    }
}
let my = new MyTransfrom();
process.stdin.on('data',function (chunk) { // ç›‘æ§ç”¨æˆ·è¾“å…¥å†…å®¹
    process.stdout.write(chunk); 
})
process.stdin.pipe(my).pipe(process.stdout)
// process.std.write('ok'); // console.log() å¯å†™æµ

</code></pre>
<h2 id="11-ç®¡é“æµ">11. ç®¡é“æµ</h2>
<pre><code class="language-javascript">
const stream = require('stream')

var index = 0;
const readable = stream.Readable({
    highWaterMark: 2,
    read: function () {
        process.nextTick(() =&gt; {
            console.log('push', ++index)
            this.push(index+'');
        })
    }
})

const writable = stream.Writable({
    highWaterMark: 2,
    write: function (chunk, encoding, next) {
        console.log('å†™å…¥:', chunk.toString())
    }
})

readable.pipe(writable);

</code></pre>

                                </div>
                    </article>
                    <!--  -->
                    
                        <div class="next-post">
                            <div class="next">ä¸‹ä¸€ç¯‡</div>
                            <a href="https://feiyayshx.github.io/web-architecture/post/node-fs/">
                                <h3 class="post-title">
                                    Nodeç³»åˆ—ä¹‹fsæ¨¡å—
                                </h3>
                            </a>
                        </div>
                        
                            <div id="disqus_thread"></div>
                            <div id="gitalk-container"></div>
                </div>
                <!-- middle -->
                <div class="main-container-middle"></div>
                <!-- right -->
                <div id="sidebar" class="main-container-right">
                    
                        <!-- toc -->
                        
    <div class="toc-card i-card ">
        <div class="toc-title i-card-title">ç›®å½•</div>
        <div class="toc-content">
            <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#1-%E6%B5%81%E7%9A%84%E6%A6%82%E5%BF%B5">1. æµçš„æ¦‚å¿µ</a></li>
<li><a href="#2-node%E4%B8%AD%E5%9B%9B%E7%A7%8D%E5%9F%BA%E6%9C%AC%E7%9A%84%E6%B5%81%E7%B1%BB%E5%9E%8B">2. Nodeä¸­å››ç§åŸºæœ¬çš„æµç±»å‹</a></li>
<li><a href="#3-%E6%B5%81%E7%9A%84%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%BC%8F">3. æµçš„æ•°æ®æ¨¡å¼</a></li>
<li><a href="#4-%E5%8F%AF%E8%AF%BB%E6%B5%81%E7%9A%84%E8%AF%BB%E5%8F%96%E6%A8%A1%E5%BC%8F">4. å¯è¯»æµçš„è¯»å–æ¨¡å¼</a></li>
<li><a href="#5-%E5%8F%AF%E8%AF%BB%E6%B5%81%E7%9A%84%E4%B8%89%E7%A7%8D%E7%8A%B6%E6%80%81">5. å¯è¯»æµçš„ä¸‰ç§çŠ¶æ€</a></li>
<li><a href="#6-%E7%BC%93%E5%86%B2">6. ç¼“å†²</a></li>
<li><a href="#7-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8F%AF%E8%AF%BB%E6%B5%81">7.  è‡ªå®šä¹‰å¯è¯»æµ</a></li>
<li><a href="#8-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8F%AF%E5%86%99%E6%B5%81">8. è‡ªå®šä¹‰å¯å†™æµ</a></li>
<li><a href="#9-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8F%8C%E5%B7%A5%E6%B5%81">9. è‡ªå®šä¹‰åŒå·¥æµ</a></li>
<li><a href="#10-%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BD%AC%E6%8D%A2%E6%B5%81">10. è‡ªå®šä¹‰è½¬æ¢æµ</a></li>
<li><a href="#11-%E7%AE%A1%E9%81%93%E6%B5%81">11. ç®¡é“æµ</a></li>
</ul>
</li>
</ul>

        </div>
        <script>
            function locateCatelogList() {
                /*è·å–æ–‡ç« ç›®å½•é›†åˆ,å¯é€šè¿‡:headerè¿‡æ»¤å™¨*/
                var alis = $('.post-content :header');
                /*è·å–ä¾§è¾¹æ ç›®å½•åˆ—è¡¨é›†åˆ**/
                var sidebar_alis = $('.markdownIt-TOC a');
                /*è·å–æ»šåŠ¨æ¡åˆ°é¡¶éƒ¨çš„è·ç¦»*/
                var scroll_height = $(window).scrollTop();
                for (var i = 0; i < alis.length; i++) {
                    /*è·å–é”šç‚¹é›†åˆä¸­çš„å…ƒç´ åˆ†åˆ«åˆ°é¡¶ç‚¹çš„è·ç¦»*/
                    var a_height = $(alis[i]).offset().top;
                    if (a_height < scroll_height) {
                        /*é«˜äº®æ˜¾ç¤º*/
                        sidebar_alis.removeClass('on');
                        $(sidebar_alis[i]).addClass('on');
                    }
                }
            }
            $(function() {
                /*ç»‘å®šæ»šåŠ¨äº‹ä»¶ */
                $(window).bind('scroll', locateCatelogList);
            });
        </script>
    </div>
    
                            

                </div>




            </div>


            <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | 
  <a class="rss" href="https://feiyayshx.github.io/web-architecture/atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>


    </div>
    <script>
        $('#sidebar').stickySidebar({
            topSpacing: 80,
            // bottomSpacing: 60
        });
    </script>
    
</body>

</html>